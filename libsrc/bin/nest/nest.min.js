var nest;!function(e){}(nest||(nest={}));var nest;if(function(e){var t;!function(t){function n(t){for(var n=["user","iap","share","social","app"],r=0;r<n.length;r++){var o=n[r];if(e[t]&&e[t][o]){e[o]=e[t][o];for(var i in e[o]){var l=e[o][i];"function"==typeof l&&a(o,i)}}}}function a(t,n){var a,r=e[t][n];a="isSupport"==n?function(e,a){c("[Nest]调用接口nest."+t+"."+n);var o=e,i=a;"function"==typeof e&&(o={},i=e);var l=function(e){c("[Nest]获得nest."+t+"."+n+"接口返回 : "+JSON.stringify(e)),i.call(null,e)};r.call(null,o,l)}:function(e,a){c("[Nest]调用接口nest."+t+"."+n);var o=function(e){c("[Nest]获得nest."+t+"."+n+"接口返回 : "+JSON.stringify(e)),a.call(null,e)};r.call(null,e,o)},e[t][n]=a}function r(){return void 0==t.$spid&&(t.$spid=parseInt(s("egret.runtime.spid"))),t.$spid}function o(){return void 0==u&&(u=s("channelTag")),u}function i(){return void 0==p&&(p=l(9392)),p}function l(e){return r()==e}function s(e){if(t.$EGRET_SUPPORT)return egret.getOption(e);if(window.location){var n=location.search;if(""==n)return"";n=n.slice(1);for(var a=n.split("&"),r=a.length,o=0;r>o;o++){var i=a[o],l=i.split("=");if(l[0]==e)return l[1]}}return""}function c(e){}t.$DEBUG_LOG=!1,t.$changeMethod=n,t.$getSpid=r;var u;t.$getChannelTag=o;var p;t.$isQQBrowser=i,t.$isTargetPlatform=l,t.$getOption=s,t.$log=c}(t=e.utils||(e.utils={}))}(nest||(nest={})),this.navigator?nest.utils.$isRuntime=!1:nest.utils.$isRuntime=!0,nest.utils.$isRuntime&&(10044==egret_native.getOption("egret.runtime.spid")||!egret_native.getOption("egret.runtime.nest")))var CMPAY_EGRET=function(){function e(){}function t(){for(var e=o.length,t=0;e>t;++t)o[t]();o.length=0}function n(){function e(e){var t;try{t=JSON.stringify(e).replace(/"/g,"`")}catch(n){return!1}return console.log("ssss:runtime-send:"+t),egret.ExternalInterface.call("newWebViewInstance",JSON.stringify({action:"callWebViewMethod",data:{methodName:"egretRuntimeOnMessage",paramStr:t}})),!0}function n(t,n){var a;if(n&&"object"==typeof n&&"number"==typeof(a=n.length))for(var r="on"===t,o="off"===t,l=0;a>l;++l){var s=n[l];if("function"==typeof s){var c=String(Math.random());o?delete i[c]:i[c]={isPersist:r,fn:s},n[l]={token:c}}}e({type:"cmpay_invoke",args:n,method:t})}function a(e){for(var t=[],n=e.length,a=0;n>a;++a)t.push(e[a]);return t}var o=!1;"boolean"==typeof CMPAY_DEBUG?o=CMPAY_DEBUG:CMPAY_DEBUG=!1,console.log("ssss:initOld:"+o);var i={};egret.ExternalInterface.addCallback("webview_to_runtime_js_data",function(e){console.log("ssss:runtime-recv:"+e);var n;try{n=JSON.parse(e)}catch(a){return}if(n&&n.type)switch(n.type){case"cmpay_loaded":return r.isReady=!0,void t();case"cmpay_invoke":var o,l=n.token;return void(l&&i.hasOwnProperty(l)&&i[l]&&"function"==typeof(o=i[l].fn)&&(i[l].isPersist||delete i[l],o.apply(null,n.args)))}});var l="http://game.liebao.cn/game/pay/part/cmpay-runtime-proxy-egret.html?";l+="_t="+Math.floor(Date.now()/3600/24/1e3),o&&(l+="&debug=1"),egret.ExternalInterface.call("newWebViewInstance",JSON.stringify({action:"createHiddenWebView",data:{url:l}})),console.log("ssss:runtime-create:"+l);for(var s=["on","off","fire","purchase"],c=s.length-1;c>-1;--c)!function(e){r[e]=function(){n(e,a(arguments))}}(s[c])}function a(){function e(e,t){var n=String(Math.random());egret.ExternalInterface.addCallback("wsj_pay",function(e){var a;try{a=JSON.parse(e)}catch(r){}if(a&&a.token===n){var o;try{o=JSON.parse(a.response)}catch(r){}t(o)}}),console.log("tttt:wsj_pay:"+JSON.stringify({token:n,request:e})),egret.ExternalInterface.call("wsj_pay",JSON.stringify({token:n,request:JSON.stringify(e)}))}function n(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var a=e[n],r=typeof a;("number"===r||"string"===r||"boolean"===r)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}return t.join("&")}function a(e,t){var a=new egret.URLLoader,r=new egret.URLRequest;e.method&&"post"===e.method.toLowerCase()&&(r.method=egret.URLRequestMethod.POST);var o="";e.data&&(o="string"==typeof e.data?e.data:n(e.data),r.data=new egret.URLVariables(o)),r.url=e.url,a.dataFormat=egret.URLLoaderDataFormat.TEXT,a.addEventListener(egret.Event.COMPLETE,function(){console.log("tttt:netreq:complete:"+a.data),t(a.data)}),console.log("tttt:netreq:"+r.url+":"+o),a.load(r)}function o(e,t){console.log("ssss:placeOrderProxy:"+JSON.stringify(e));var r=e.data&&e.data.access_token;if(r)if(32===r.length||"sdk"===r.slice(0,3)){var o={token:r,method:e.pay_method,dev:e.debug?1:null},i=e.data;for(var l in i)i.hasOwnProperty(l)&&"access_token"!==l&&(o[l]=i[l]);a({method:"POST",url:"http://gclogin.liebao.cn/api/native/order/pay",data:o},t)}else a({method:"POST",url:"http://gc.liebao.cn/pay/topay.php",data:{method:e.pay_method,args:n(e.data),dev:e.debug?1:null}},t);else t(!1,-1,'{"msg":"Token not provided."}')}function i(e,t){o(e,function(e){var n,a=!1,r="Unkown error";if(e){e=e.replace(/"transaction_id":(\d+)/,'"transaction_id":"$1"');try{n=JSON.parse(e),a=!0}catch(o){r="Empty response"}}var i=a&&n&&n.data&&n.data.args&&n.data.args.goodsTokenUrl&&1===n.ret;if(i){var l=n.data.args.goodsTokenUrl;r=l?"ok":"Empty goods token url"}t(i,i?0:n?n.ret:-1,r,n)})}var l=!1;"boolean"==typeof CMPAY_DEBUG?l=CMPAY_DEBUG:CMPAY_DEBUG=!1,console.log("ssss:initNew:"+l);var s={};r.on=function(e,t){var n;n=s.hasOwnProperty(e)?s[e]:s[e]=[],n.push(t)},r.off=function(e,t){var n;s.hasOwnProperty(e)&&(n=s[e]);for(var a=n.length,r=0;a>r;++r)n[r]===t&&n.splice(r,1)},r.fire=function(e){if(s.hasOwnProperty(e))for(var t=[].slice.call(arguments,1),n=s[e],a=n.length,r=n.slice(),o=0;a>o;++o){var i=r[o];try{i.apply(null,t)}catch(l){}}},r.isReady=!0,r.purchase=function(t){console.log("ssss:purchase:"+JSON.stringify(t)),i({pay_method:"wsjpay/sdk",data:t,debug:"undefined"!=typeof t.debug?t.debug:l},function(t,n,a,o){r.fire("cmpay_order_placed",{type:"cmpay_order_placed",transaction_id:o&&o.data?o.data.transaction_id:null,ret:n,msg:a,success:t,response:o}),t?e(o.data.args,function(e){var t=e&&"number"==typeof e.resultCode?e.resultCode:-99,n=e&&0===e.resultCode;r.fire("cmpay_order_complete",{type:"cmpay_order_complete",transaction_id:o.data.transaction_id,ret:t,success:n,payed:n,paid:n,wsjResponse:e})}):r.fire("cmpay_order_complete",{type:"cmpay_order_complete",transaction_id:o&&o.data?o.data.transaction_id:null,ret:-99,success:!1,payed:!1,paid:!1,wsjResponse:null})})},t()}var r={on:e,off:e,ready:e,isReady:!1,fire:e,purchase:e,getVersion:e,type:"egret_runtime"},o=[];r.ready=function(e){r.isReady?e():o.push(e)};var i=!1;r.getVersion=function(){return i};var l=egret.setTimeout(function(){i===!1?n():a()},null,100);return egret.ExternalInterface.addCallback("get_game_sdk_version",function(e){egret.clearTimeout(l),console.log("ssss:get_game_sdk_version:"+JSON.stringify(arguments)),i=e,a()}),egret.ExternalInterface.call("get_game_sdk_version",""),r}();if(nest.utils.$isRuntime&&(10044==egret_native.getOption("egret.runtime.spid")||!egret_native.getOption("egret.runtime.nest")))var CMGAME_EGRET=function(){function e(e,t){var n=!1,a=!1,r=egret.setTimeout(function(){a||(a=!0,t(n))},null,e);egret.ExternalInterface.addCallback("get_game_sdk_version",function(e){console.log("ssss:get_game_sdk_version"+JSON.stringify(arguments)),egret.clearTimeout(r),a||(a=!0,n=e,t(n))}),egret.ExternalInterface.call("get_game_sdk_version","")}var t={};return t.checkIsGameSDK=function(){var t=!1,n=!0,a=-1,r=!1,o=[];return function(i){if(t)egret.setTimeout(function(){i(n,a)},null,1);else if(o.push(i),!r){r=!0;var l=function(){t=!0,egret.setTimeout(function(){console.log("sssstttt:CMGAME.checkIsGameSDK call listeners"),r=!1;for(var e=0;e<o.length;++e)try{o[e](n,a)}catch(t){console.log(t)}o.length=0},null,1)};console.log("sssstttt:get_game_sdk_version()"),e(1e4,function(e){console.log("sssstttt:get_game_sdk_version():"+JSON.stringify(arguments)),e&&!isNaN(e)&&(a=e),l()})}}}(),t.saveShortcutInfo=function(e,t){egret.ExternalInterface.call("save_shortcut_info",JSON.stringify({token:String(Math.random()),value:JSON.stringify(e)}))},t.pushIcon=function(e,t){e.title=e.Title,e.detailUrl=e.DetailUrl,e.picUrl=e.PicUrl,egret.ExternalInterface.call("push_icon",JSON.stringify(e))},t.dispatchGameLoginData=function(){var e;return egret.ExternalInterface.addCallback("dispatchGameLoginData",function(t){if(console.log("sssstttt:dispatchGameLoginData:callback:"+t),e){var n=!1;if("string"==typeof t)try{n=JSON.parse(t)}catch(a){}else n=t;e(n)}}),function(t,n){var a=e;e=function(t){e=a,n(t)},egret.ExternalInterface.call("dispatchGameLoginData",JSON.stringify(t))}}(),t.getGameSDKDeviceID=function(){throw"Method not exists, use CMGAME_LAYA.getGameSDKDeviceIDAsync() instead."},t.getGameSDKDeviceIDAsync=function(e){var t;return egret.ExternalInterface.addCallback("get_device_info",function(e){if(t){var n=!1;if("string"==typeof e)try{n=JSON.parse(e)}catch(a){}else n=e;t(n)}}),function(e){var n=t;t=function(a){t=n,e(a)},egret.ExternalInterface.call("get_device_info","")}}(),t}();var nest;!function(e){var t;!function(t){function n(e,t,n){void 0===n&&(n=!1);var r="nest";n?(egret.ExternalInterface.addCallback(r,function(e){var n=JSON.parse(e);t(n.data)}),egret.ExternalInterface.call(r,JSON.stringify(e))):(u.push({data:e,callback:t}),a())}function a(){if(u.length){if(p)return;p=!0;var e=u.shift(),t="nest";egret.ExternalInterface.addCallback(t,function(t){var n=JSON.parse(t);e.callback(n.data),p=!1,a()}),egret.ExternalInterface.call(t,JSON.stringify(e.data))}}var r;!function(e){function t(e,t){var a={module:"core",action:"callCustomMethod",param:e};n(a,t)}e.callCustomMethod=t}(r=t.core||(t.core={}));var o;!function(e){function t(e,t){var a={module:"user",action:"isSupport",param:e};n(a,t)}function a(e,t){var a={module:"user",action:"checkLogin",param:e};n(a,t)}function r(e,t){var a={module:"user",action:"login",param:e};n(a,t,!0)}function o(e,t){var a=egret.getOption("egret.runtime.nest");if(a>=4||"custom"==a){var r={module:"user",action:"logout",param:e};n(r,t)}else t({result:0})}function i(e){var t={module:"user",action:"getInfo"};n(t,e)}e.isSupport=t,e.checkLogin=a,e.login=r,e.logout=o,e.getInfo=i}(o=t.user||(t.user={}));var i;!function(e){function t(e,t){var a={module:"iap",action:"pay",param:e};n(a,t)}e.pay=t}(i=t.iap||(t.iap={}));var l;!function(e){function t(e,t){var a={module:"share",action:"isSupport",param:e};n(a,t)}function a(e,t){t.call(null,{result:-2})}function r(e,t){var a={module:"share",action:"share",param:e};n(a,t,!0)}e.isSupport=t,e.setDefaultData=a,e.share=r}(l=t.share||(t.share={}));var s;!function(e){function t(e,t){var a={module:"social",action:"isSupport",param:e};n(a,t)}function a(e,t){var a={module:"social",action:"getFriends",param:e};n(a,t)}function r(e,t){var a={module:"social",action:"openBBS",param:e};n(a,t)}e.isSupport=t,e.getFriends=a,e.openBBS=r}(s=t.social||(t.social={}));var c;!function(t){function a(e,t){var a={module:"app",action:"isSupport",param:e};n(a,t)}function r(e,t){var a={module:"app",action:"attention",param:e};n(a,t)}function o(e,t){var a={module:"app",action:"exitGame",param:e};n(a,t)}function i(e,t){var a={module:"app",action:"sendToDesktop",param:e};n(a,t)}function l(t,n){var a=e.utils.$API_DOMAIN+"user/getCustomInfo";a+="?appId="+e.utils.$APP_ID,a+="&runtime=1",a+="&egretChanId="+e.utils.$getSpid();var r=new egret.HttpRequest;r.open(a),r.addEventListener(egret.Event.COMPLETE,function(){var e=JSON.parse(r.response),t=e.data;t.result=0,0==e.code?n.call(null,t):n.call(null,{result:-2})},this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){n.call(null,{result:-2})},this),r.send()}t.isSupport=a,t.attention=r,t.exitGame=o,t.sendToDesktop=i,t.getInfo=l}(c=t.app||(t.app={}));var u=[];t.callRuntime=n;var p=!1;t._getData=a}(t=e.runtime||(e.runtime={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(e,t){var n;if(n=egret.localStorage.getItem("deviceid")){if(console.log("cm old local deviceid "+n),n.indexOf("{")>=0){var a=JSON.parse(n);e.postData.deviceid=a.did}else e.postData.deviceid=n;i(e.postData,t)}else{console.log("cm old CMPAY_EGRET.version "+CMPAY_EGRET.getVersion());var r=0==CMPAY_EGRET.getVersion()||0==CMPAY_EGRET.getVersion()?"getUid":"get_device_info",o=!1,l=function(n){o||(o=!0,console.log(n),e.postData.deviceid=n||egret.localStorage.getItem("deviceid")||"",i(e.postData,t))};egret.ExternalInterface.addCallback(r,function(e){if(console.log("cm old CMPAY_EGRET"),"get_device_info"==r)if(console.log("cm old get_device_info "+e),e){var t=JSON.parse(e);l(t.did)}else l(null);else l(e)}),egret.setTimeout(function(){console.log("cm old timeout"),l(null)},this,2e3),egret.ExternalInterface.call(r,"")}}function a(t){var n={},a=e.utils.$API_DOMAIN+"app/getInfo";n.egretChanId=e.utils.$getSpid(),n.egretGameId=e.utils.$APP_ID,n.debug=1,l(a,n,egret.URLRequestMethod.GET,function(e){t(e)})}function r(t,n,a){var r={};r.access_token=t.access_token,r.openid=t.openid;var o=e.utils.$API_DOMAIN+"game/"+e.utils.$getSpid()+"/"+e.utils.$APP_ID+"/";r.runtime=1,r.showGame=1,a&&(r.newLiebaoApi=1),l(o,r,egret.URLRequestMethod.GET,function(e){n(e)})}function o(n,a){var r=e.utils.$API_DOMAIN+"user/placeOrder",o={id:t.user.egretInfo.egretUserId,appId:e.utils.$APP_ID,time:Date.now(),runtime:1};for(var i in n)o[i]=n[i];l(r,o,egret.URLRequestMethod.GET,function(e){a(e)})}function i(e,t){var n="http://gclogin.liebao.cn/api/user/quick_register";l(n,e,egret.URLRequestMethod.POST,t)}function l(e,t,n,a){var r="";for(var o in t)r+=o+"="+t[o]+"&";""!=r&&(r=r.substr(0,r.length-1)),console.log("cm old solution ="+e+"?"+r);var i=new egret.URLLoader;i.addEventListener(egret.Event.COMPLETE,function(){console.log("cm old solution  ="+i.data);var e=JSON.parse(i.data);a(e)},this);var l=new egret.URLRequest(e);l.method=n,l.data=new egret.URLVariables(r),i.load(l)}t.callRuntime=n,t.loginBefore=a,t.loginAfter=r,t.payBefore=o}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){var n;!function(t){function n(n,a){function r(e){t.egretInfo={egretUserId:e.data.id},e.data.result=e.status,a(e.data)}function o(t){1==t.ret?(t.access_token=t.ssid,egret.localStorage.getItem("deviceid")||egret.localStorage.setItem("deviceid",t.deviceid),e.cm.loginAfter(t,r,!1)):a({result:1})}function i(t){console.log("cm old loginHandler1"),console.log(JSON.stringify(t,null,4));var n={};n.access_token=t.cp.token,n.openid=t.user.openid,egret.localStorage.setItem("cm_token",n.access_token),console.log("cm old loginHandler2"),e.cm.loginAfter(n,r,!0)}function l(t){if(0==t.code){var r=t.data;s.client_id=r.client_id,s.client_secret=r.client_secret,s.redirect_uri=r.redirect_uri,e.cm.app.$initDesktop({Title:r.title,DetailUrl:r.detailUrl,PicUrl:r.picUrl}),CMGAME_EGRET.checkIsGameSDK(function(t,a){if(t){console.log("cm old checkIsGameSDK1");var l={clientId:r.client_id,clientSecret:r.client_secret,redirectUri:r.redirect_uri};egret.localStorage.getItem("cm_token"),console.log(JSON.stringify(l,null,4)),console.log("cm old checkIsGameSDK2"),CMGAME_EGRET.dispatchGameLoginData(l,i)}else console.log("cm old checkIsGameSDK2"),e.cm.callRuntime({module:"user",action:"checkLogin",param:n,postData:s},o)})}else a({result:1})}var s={};e.cm.loginBefore(l)}function a(t,n){var a={module:"user",action:"login",param:t};e.cm.callRuntime(a,n)}t.checkLogin=n,t.login=a}(n=t.user||(t.user={}))}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(t){function n(t,n){var r=0,o=-1,i=-2;e.payBefore(t,function(e){if(0==e.code){a&&(CMPAY_EGRET.on("cmpay_order_complete",function(e){console.log("cm old solution cmpay_order_complete  "+JSON.stringify(e,null,4)),n(1==e.success?{result:r}:2==e.ret?{result:o}:{result:i})}),a=!1);var t={access_token:e.data.access_token,client_id:e.data.client_id,product_id:e.data.product_id,unit:e.data.unit,payload:e.data.payload,notify_url:e.data.notify_url,money:e.data.money,order_name:e.data.order_name,game_icon:e.data.game_icon,game_name:e.data.game_name};CMPAY_EGRET.purchase(t)}else n({result:i})})}var a=!0;t.pay=n}(t=e.iap||(e.iap={}))}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(e){function t(e,t){t({result:0,share:0})}e.isSupport=t}(t=e.share||(e.share={}))}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(e){function t(e){r=e,egret.ExternalInterface.call("save_shortcut_info",JSON.stringify({token:String(Math.random()),value:JSON.stringify(e)}))}function n(e,t){t(0!=CMPAY_EGRET.getVersion()&&!isNaN(CMPAY_EGRET.getVersion())&&CMPAY_EGRET.getVersion()>301030?{result:0,sendToDesktop:1,attention:0}:{result:0,sendToDesktop:0,attention:0})}function a(e,t){r?(egret.ExternalInterface.call("push_icon",JSON.stringify({title:r.Title,detailUrl:r.DetailUrl,picUrl:r.PicUrl})),t({result:0})):t({result:-1})}var r;e.$initDesktop=t,e.isSupport=n,e.sendToDesktop=a}(t=e.app||(e.app={}))}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(e,t,n,a){var r="";for(var o in t)r+=o+"="+t[o]+"&";""!=r&&(r=r.substr(0,r.length-1)),console.log("[Nest]qq hall send : "+e+"?"+r);var i=new egret.URLLoader;i.addEventListener(egret.Event.COMPLETE,function(){console.log("[Nest]qq hall get data : "+i.data);var e=JSON.parse(i.data);a(e)},this);var l=new egret.URLRequest(e);l.method=n,l.data=new egret.URLVariables(r),i.load(l)}function a(a,r){var o=e.utils.$API_DOMAIN+"user/placeOrder",i={id:t.userId,appId:e.utils.$APP_ID,time:Date.now(),openid:t.OpenId,openkey:t.OpenKey,paytoken:t.payToken,runtime:1};for(var l in a)i[l]=a[l];n(o,i,egret.URLRequestMethod.GET,function(e){r(e)})}function r(e){var t=JSON.stringify(e);egret.ExternalInterface.call("HALL_EGRET_MSG_FROM",t)}function o(){egret.ExternalInterface.addCallback("HALL_EGRET_MSG_TO",function(a){var o=JSON.parse(a);switch(o.msgType){case t.login_callback_type:if(null==o.accessToken){if(t.loginNum++,t.loginNum>=3){var i={result:-1,token:void 0};return t.loginCallback.call(null,i),void(t.loginCallback=null)}var l="OpenId/OpenKey 为空";return r({msgType:t.login_back_call_type,msgVersion:t.version,errorID:1,loginInfoStr:l}),void r({msgType:t.login_call_type,msgVersion:t.version})}if(t.loginCallback){t.gameType=o.msgType,t.gameVersion=o.msgVersion,t.OpenId=o.openId,t.OpenKey=o.accessToken,t.enterType=o.enterType,t.enterId=o.enterId,t.payToken=o.payToken;var l="登录成功";r({msgType:t.login_back_call_type,msgVersion:t.version,errorID:0,loginInfoStr:l});var s=e.utils.$API_DOMAIN+"game/"+e.utils.$getSpid()+"/"+e.utils.$APP_ID,c={};c.openkey=t.OpenKey,c.openid=t.OpenId,c.paytoken=t.payToken,c.runtime=1,c.showGame=1,n(s,c,egret.URLRequestMethod.GET,function(e){var n=e.data;t.userId=n.id,t.loginCallback.call(null,n),t.loginCallback=null})}break;case t.pay_callback_type:if(t.payCallback){var u=-1;switch(o.payState){case-1:case 1:case 2:t.payOrderInfo=null,t.payCallback.call(null,{result:u,status:u}),t.payCallback=null;break;case 0:t.iap.repay()}}break;case t.share_callback_type:if(t.shareCallback){var u=o.errorid;t.shareCallback.call(null,{result:u,status:u}),t.shareCallback=null}}})}t.login_call_type=102,t.login_back_call_type=100,t.pay_call_type=101,t.share_call_type=104,t.login_callback_type=200,t.pay_callback_type=201,t.share_callback_type=204,t.loginCallback=null,t.payCallback=null,t.shareCallback=null,t.version="V1.0.0",t.loginNum=0,t.payBefore=a,t.callHall=r,t.init=o}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(t){function n(e,t){var n=0,a={status:n,result:n,checkLogin:0,login:1,logout:0,getInfo:0};t.call(null,a)}function a(e,t){var n=-1,a={status:n,result:n,loginType:void 0,token:void 0};t.call(null,a)}function r(t,n){e.loginCallback=n,e.callHall({msgType:e.login_call_type,msgVersion:e.version})}t.isSupport=n,t.checkLogin=a,t.login=r}(t=e.user||(e.user={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(t){function n(t,n){e.payOrderInfo||(e.payOrderInfo=t,e.payBefore(t,function(t){t=t.data,0==t.code?n.call(null,{result:0,status:0}):(e.payCallback=n,e.callHall({msgType:e.pay_call_type,msgVersion:"V1.0.0",acctType:"",zoneId:"",payValue:t.qCoins,isCanChange:!1}))}))}function a(){if(e.payOrderInfo){var t=e.payOrderInfo,n=e.payCallback;e.payBefore(t,function(e){e=e.data;var t=e.status;n.call(null,{result:t,status:t})}),e.payOrderInfo=null,e.payCallback=null}}t.pay=n,t.repay=a}(t=e.iap||(e.iap={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(e){function t(e,t){var n=0,a={status:n,result:n,attention:0,sendToDesktop:0,exitGame:1};t.call(null,a)}function n(e){var t=0,n={status:t,result:t};e.call(null,n)}function a(e,t){}function r(e,t){}e.isSupport=t,e.exitGame=n,e.attention=a,e.sendToDesktop=r}(t=e.app||(e.app={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(t){function n(e,t){var n=0,a={status:n,result:n,share:1};t.call(null,a)}function a(t,n){e.shareCallback=n,e.callHall({msgType:e.share_call_type,msgVersion:"V1.0.0",title:t.title,summary:t.description,imageLocalUrl:"",targetUrl:t.url})}t.isSupport=n,t.share=a}(t=e.share||(e.share={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(e){function t(e,t){var n=0,a={status:n,result:n,getFriends:0,openBBS:0};t.call(null,a)}function n(e,t){}function a(e,t){}e.isSupport=t,e.getFriends=n,e.openBBS=a}(t=e.social||(e.social={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(e,t,n,a){var r="";for(var o in t)r+=o+"="+encodeURIComponent(t[o])+"&";""!=r&&(r=r.substr(0,r.length-1));for(var i="[Nest]qq hall2 send : "+e+"?"+r,l=0;l<Math.ceil(i.length/450);l++)console.log(i.slice(450*l,450*(l+1)));var s=new egret.URLLoader;s.addEventListener(egret.Event.COMPLETE,function(){console.log("[Nest]qq hall2 get data : "+s.data);var e=JSON.parse(s.data);a(e)},this);var c=new egret.URLRequest(e);c.method=n,c.data=new egret.URLVariables(r),s.load(c)}function a(t,a){var r=e.utils.$API_DOMAIN+"app/getSignInfo",o={egretChanId:e.utils.$getSpid(),appId:e.utils.$APP_ID};n(r,o,egret.URLRequestMethod.GET,function(e){a(e)})}function r(t,a){var r=e.utils.$API_DOMAIN+"user/placeOrder",o={id:R,appId:e.utils.$APP_ID,time:Date.now(),qbopenkey:D,runtime:1};for(var i in t)o[i]=t[i];n(r,o,egret.URLRequestMethod.GET,function(e){a(e)})}function o(t,a){var r=e.utils.$API_DOMAIN+"pay/"+e.utils.$getSpid()+"/"+e.utils.$APP_ID;n(r,t,egret.URLRequestMethod.GET,function(e){a(e)})}function i(e){var t=JSON.stringify(e);console.log("call hall : "+t),egret.ExternalInterface.call("HALL_EGRET_MSG_FROM",t)}function l(e){Z=e,i({msgType:x,appid:p,appsig:f,appsigData:g,qbopenid:T,msgVersion:tt})}function s(e){et=e,i({msgType:B,appid:p,appsig:f,msgVersion:tt})}function c(e){X=e,i({msgType:J,appid:p,qbopenid:T,refreshToken:"",msgVersion:tt})}function u(){egret.ExternalInterface.addCallback("HALL_EGRET_MSG_TO",function(t){console.log("get hall data : "+t);var a,r=JSON.parse(t);switch(r.msgType){case V:if(Q)if(a=r.result,0==a){_=r.msgType,y=r.msgVersion,k=r.openId,I=r.accessToken,S=r.enterType,E=r.enterId,O=r.payToken,T=r.qbopenid,D=r.qbopenkey,P=r.nickName,b=r.avatarUrl;var i=function(){if(Q){var t=e.utils.$API_DOMAIN+"game/"+e.utils.$getSpid()+"/"+e.utils.$APP_ID,a={};a.openId=k,a.accessToken=I,a.payToken=O,a.qbopenid=T,a.qbopenkey=D,a.nickName=P,a.avatarUrl=b,a.balance=nt,a.gen_balance=d,a.first_save=v,a.save_amt=m,a.pf=M,a.baseinfo=JSON.stringify(h),a.runtime=1,n(t,a,egret.URLRequestMethod.GET,function(e){var t=e.data;R=t.id,Q.call(null,t),Q=null})}},c=!1,u=!1;l(function(){c=!0,c&&u&&i()}),s(function(){u=!0,c&&u&&i()})}else Q.call(null,{result:-2}),Q=null;break;case H:if(W){if(0!=q){var p={};p.realSaveNum=r.realSaveNum,p.orderno=r.orderno,p.customMeta=L,o(p,function(e){0==e.code?(A=null,W.call(null,{result:0,status:0}),W=null):(A=null,W.call(null,{result:-2,status:-2}),W=null)});break}l(function(){rt.repay()})}break;case Y:z&&(a=r.errorid,z.call(null,{result:a,status:a}),z=null);break;case F:0==r.result&&(D=r.qbopenkey),X&&(X.call(null),X=null);break;case K:0==r.result&&(nt=r.balance,d=r.gen_balance,v=r.first_save,m=r.save_amt),Z&&(Z.call(null),Z=null);break;case j:0==r.result&&(h=r.baseinfo),et&&(et.call(null),et=null)}})}var p,f,g,d,v,m,h,_,y,k,I,S,E,O,T,D,P,b,R,M,A,q,C,$,N,L,G=100,U=101,w=104,J=106,x=107,B=108,V=200,H=201,Y=204,F=206,K=207,j=208,Q=null,W=null,z=null,X=null,Z=null,et=null,tt="1.0.0",nt=0;t.init=u;var at;!function(e){function t(e,t){var n=0,a={status:n,result:n,checkLogin:0,login:1,logout:0,getInfo:0};t.call(null,a)}function n(e,t){var n=-1,a={status:n,result:n,loginType:void 0,token:void 0};t.call(null,a)}function r(e,t){a(null,function(n){p=n.data.appid,f=n.data.appsig,g=n.data.appsigdata,Q=t,M=e.loginType,i({msgType:G,appid:p,appsig:f,appsigData:g,loginType:M,msgVersion:tt})})}e.isSupport=t,e.checkLogin=n,e.login=r}(at=t.user||(t.user={}));var rt;!function(e){function t(e,t){A||(A=e,c(function(){r(e,function(e){e=e.data,C=e.payValue,N=e.payInfo,$=e.payItem,L=e.customMeta,W=t,q=C>nt?0:1,a()})}))}function n(){C>nt?W&&(A=null,W.call(null,{result:-2,status:-2}),W=null):(q=1,a())}function a(){i({msgType:U,msgVersion:tt,payType:q,appid:p,appsig:f,appsigData:g,payItem:$,payInfo:N,reqTime:Date.now(),customMeta:L,payValue:C,qbopenid:T,qbopenkey:D,isCanChange:!1})}e.pay=t,e.repay=n}(rt=t.iap||(t.iap={}));var ot;!function(e){function t(e,t){var n=0,a={status:n,result:n,attention:0,sendToDesktop:0,exitGame:0};t.call(null,a)}function n(e){var t=0,n={status:t,result:t};e.call(null,n)}function a(e,t){}function r(e,t){}e.isSupport=t,e.exitGame=n,e.attention=a,e.sendToDesktop=r}(ot=t.app||(t.app={}));var it;!function(e){function t(e,t){var n=0,a={status:n,result:n,share:1};t.call(null,a)}function n(e,t){z=t,c(function(){i({msgType:w,msgVersion:tt,appid:p,appsig:f,appsigData:g,qbopenid:T,qbopenkey:D,title:e.title,summary:e.description,imageLocalUrl:e.img_url,img_title:e.title,cus_txt:"",targetUrl:e.url})})}e.isSupport=t,e.share=n}(it=t.share||(t.share={}));var lt;!function(e){function t(e,t){var n=0,a={status:n,result:n,getFriends:0,openBBS:0};t.call(null,a)}function n(e,t){}function a(e,t){}e.isSupport=t,e.getFriends=n,e.openBBS=a}(lt=t.social||(t.social={}))}(t=e.qqhall2||(e.qqhall2={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){t.uid=void 0;var n;!function(t){function n(t,n){var a=[];e.utils.$isQQBrowser()&&(a.push("qq"),a.push("wx"));var r={result:0,loginType:a,getInfo:0};n.call(null,r)}function a(t,n){var a=function(t){e.h5.uid=t.id;var a=t.status;e.h5.uid&&(a=0);var r={result:a,token:t.token};n.call(null,r)};EgretH5Sdk.checkLogin(a,null)}function r(t,n){var a=function(t){e.h5.uid=t.id;var a=t.status;e.h5.uid&&(a=0);var r={result:a,token:t.token};n.call(null,r)};EgretH5Sdk.login(a,null,t.loginType)}function o(e,t){var n=function(e){var n=e.status,a=1==n?0:1;t.call(null,{result:a})};EgretH5Sdk.logout(n,null)}t.isSupport=n,t.checkLogin=a,t.login=r,t.logout=o}(n=t.user||(t.user={}));var a;!function(t){function n(t,n){e.h5.uid&&(t.appId=e.utils.$APP_ID,t.uId=e.h5.uid,EgretH5Sdk.pay(t,function(e){n(e)},this))}t.pay=n}(a=t.iap||(t.iap={}));var r;!function(t){function n(t,n){var a=function(e){var t=e.status,a={share:t};n.call(null,a)};EgretH5Sdk.isOpenShare(e.utils.$APP_ID,e.h5.uid,a,null)}function a(t,n){var a=function(e){var t=e.status;0==t?t=-1:1==t&&(t=0);var a={status:t,result:t};n.call(null,a)};EgretH5Sdk.share(e.utils.$APP_ID,e.h5.uid,t,a,null)}t.isSupport=n,t.share=a}(r=t.share||(t.share={}));var o;!function(e){function t(e,t){t.call(null,{result:0,getFriends:0,openBBS:0})}function n(e,t){}function a(e,t){}e.isSupport=t,e.getFriends=n,e.openBBS=a}(o=t.social||(t.social={}));var i;!function(t){function n(t,n){var a=function(e){var t=e.status,a={attention:t};n.call(null,a)};EgretH5Sdk.isOpenAttention(e.utils.$APP_ID,e.h5.uid,a,null)}function a(t,n){EgretH5Sdk.attention(e.utils.$APP_ID,e.h5.uid),n.call(null,{result:0})}function r(e,t){t.call(null,{result:-1})}function o(t,n){var a=function(e){var t={result:0,contact:e.contact};n.call(null,t)};EgretH5Sdk.getCustomInfo(e.utils.$APP_ID,e.h5.uid,a,null)}t.isSupport=n,t.attention=a,t.sendToDesktop=r,t.getInfo=o}(i=t.app||(t.app={}))}(t=e.h5||(e.h5={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){var n;!function(t){function n(t,n){var a=[];e.utils.$isQQBrowser()&&(a.push("qq"),a.push("wx"));var r={result:0,loginType:a,getInfo:0};n.call(null,r)}function a(e,t){EgretH5Sdk.checkLogin(e,t)}function r(e,t){EgretH5Sdk.login(e,t)}function o(e,t){EgretH5Sdk.logout(e,t)}function i(e,t){t.call(null,{result:-2})}t.isSupport=n,t.checkLogin=a,t.login=r,t.logout=o,t.getInfo=i}(n=t.user||(t.user={}));var a;!function(e){function t(e,t){EgretH5Sdk.pay(e,t)}e.pay=t}(a=t.iap||(t.iap={}));var r;!function(e){function t(e,t){var n=function(e){var n=e.result,a={share:n,msg:e.msg};t.call(null,a)};EgretH5Sdk.isSupportShare({},n)}function n(e,t){e.imgUrl=e.img_url,EgretH5Sdk.setShareDefaultData(e,t)}function a(e,t){e.imgUrl=e.img_url,EgretH5Sdk.share(e,t)}e.isSupport=t,e.setDefaultData=n,e.share=a}(r=t.share||(t.share={}));var o;!function(e){function t(e,t){t.call(null,{result:0,getFriends:0,openBBS:0})}function n(e,t){t.call(null,{result:-2})}function a(e,t){t.call(null,{result:-2})}e.isSupport=t,e.getFriends=n,e.openBBS=a}(o=t.social||(t.social={}));var i;!function(e){function t(e,t){var n=function(e){var n=e.result,a={attention:n,getInfo:1,exitGame:0,sendToDesktop:0};t.call(null,a)};EgretH5Sdk.isSupportAttention({},n)}function n(e,t){EgretH5Sdk.attention({},t)}function a(e,t){t.call(null,{result:-2})}function r(e,t){t.call(null,{result:-2})}function o(e,t){EgretH5Sdk.getCustomInfo({},t)}e.isSupport=t,e.attention=n,e.sendToDesktop=a,e.exitGame=r,e.getInfo=o}(i=t.app||(t.app={}))}(t=e.h5_2||(e.h5_2={}))}(nest||(nest={})),nest.core=nest.core||{},nest.core.startup=function(e,t){try{new egret.HashObject,nest.utils.$EGRET_SUPPORT=!0}catch(n){nest.utils.$EGRET_SUPPORT=!1}var a="http://api.egret-labs.org/v2/";if(nest.utils.$APP_ID=e.egretAppId,nest.utils.$DEBUG_LOG=e.debug,nest.utils.$isRuntime)if((nest.utils.$isQQBrowser()||nest.utils.$isTargetPlatform(10080)||nest.utils.$isTargetPlatform(10835))&&(a="http://api.gz.1251278653.clb.myqcloud.com/v2/"),nest.utils.$API_DOMAIN=a,nest.core.callCustomMethod=nest.runtime.core.callCustomMethod,nest.utils.$isTargetPlatform(10044)||!nest.utils.$getOption("egret.runtime.nest")){egret_native.setOption("channelTag","liebao"),CMPAY_DEBUG=!1;var r;r=85==nest.utils.$APP_ID||88==nest.utils.$APP_ID?10044:18287,egret_native.setOption("egret.runtime.spid",r),nest.utils.$spid=r,nest.utils.$changeMethod("cm")}else if(nest.utils.$isTargetPlatform(10835)){var r;66==nest.utils.$APP_ID||86==nest.utils.$APP_ID?(r=10835,nest.qqhall.init(),nest.utils.$changeMethod("qqhall")):(r=20546,nest.qqhall2.init(),nest.utils.$changeMethod("qqhall2")),egret_native.setOption("egret.runtime.spid",r),nest.utils.$spid=r}else nest.utils.$changeMethod("runtime");else{var o=nest.utils.$getOption("egretServerDomain");o?a=o+"/":nest.utils.$API_DOMAIN=a;var i=nest.utils.$getOption("egretSdkDomain");if(i||(i=nest.utils.$API_DOMAIN),2==e.version){nest.utils.$changeMethod("h5_2");var l=i+"/misc/scripts/egreth5sdk.js",s=document.createElement("script");return s.hasOwnProperty("async")&&(s.async=!1),s.src=l,s.id="egreth5sdk",s.addEventListener("load",function(){this.removeEventListener("load",arguments.callee,!1),EgretH5Sdk.init({},t)},!1),s.addEventListener("error",function(){s.parentNode.removeChild(s),this.removeEventListener("error",arguments.callee,!1),t({result:-2})},!1),void document.head.appendChild(s)}nest.utils.$changeMethod("h5")}t({result:0})};