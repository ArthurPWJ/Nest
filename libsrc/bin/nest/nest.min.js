var nest;!function(t){var e;!function(t){}(e=t.user||(t.user={}))}(nest||(nest={}));var nest;!function(t){var e;!function(e){function n(e,n){t.core.startup(e,function(t){a(n)})}function a(e){t.user.checkLogin({},function(t){g=t,g.result=0,l(function(){e({result:0})})})}function l(e){t.user.isSupport({},function(t){d=t.getInfo;var n=t.loginTypes;if(n&&n.length)v=n;else if(t.loginType&&t.loginType.length){for(var a=t.loginType,l=[],i=0;i<a.length;i++)l.push({loginType:a[i]});v=l}else v=[];e()})}function i(){if(g&&g.token)return[];if(u()&&v&&v.length)for(var t=0;t<v.length;t++){var e=v[t];e.accInfo=null,v[t]=e}return v.concat()}function o(t,e){m?(m=!1,g&&g.token?e(g):r(t.loginType,e)):r(t.loginType,e)}function r(e,n){var a={};e&&""!=e&&"default"!=e&&(a.loginType=e),t.user.login(a,function(t){t.token?(s(),t.result=0,n(t)):(null==t.result&&(t.result=-2),n(t))})}function u(){return"1"==t.utils.localStorage.getItem("egret_logout")}function s(){return t.utils.localStorage.setItem("egret_logout",null)}function c(e,n){var a=function(e){0==e.result&&(g=null,t.utils.localStorage.setItem("egret_logout","1")),n(e)};t.user.logout(e,a)}function p(t,e){var n={result:0,getInfo:d};e(n)}function f(e,n){t.user.getInfo(e,n)}e.startup=n,e.getLoginTypes=i;var g,d,v,m=!0;e.login=o,e.logout=c,e.isSupport=p,e.getInfo=f}(e=t.easyuser||(t.easyuser={}))}(nest||(nest={}));var nest;!function(t){var e;!function(e){function n(e){for(var n=["core","user","iap","share","social","app","invite","role"],l=0;l<n.length;l++){var i=n[l];if(t[e]&&t[e][i]){null==t[i]&&(t[i]={});for(var o in t[e][i])t[i][o]=t[e][i][o];for(var o in t[i]){var r=t[i][o];"function"==typeof r&&a(i,o)}}}}function a(e,n){var a,l=t[e][n];a="isSupport"==n?function(t,a){s("[Nest]调用接口nest."+e+"."+n);var i=t,o=a;"function"==typeof t&&(i={},o=t);var r=function(t){s("[Nest]获得nest."+e+"."+n+"接口返回 : "+JSON.stringify(t)),o.call(null,t)};l.call(null,i,r)}:function(t,a){s("[Nest]调用接口nest."+e+"."+n);var i=function(t){s("[Nest]获得nest."+e+"."+n+"接口返回 : "+JSON.stringify(t)),a.call(null,t)};l.call(null,t,i)},t[e][n]=a}function l(){return void 0==e.$spid&&(e.$spid=parseInt(u("egret.runtime.spid"))),e.$spid}function i(){return void 0==p&&(p=u("channelTag")),p}function o(){return void 0==f&&(f=r(9392)),f}function r(t){return l()==t}function u(t){if(e.$EGRET_SUPPORT)return egret.getOption(t);if(window.location){var n=location.search;if(""==n)return"";n=n.slice(1);for(var a=n.split("&"),l=a.length,i=0;l>i;i++){var o=a[i],r=o.split("=");if(r[0]==t)return r[1]}}return""}function s(t){e.$DEBUG_LOG&&(e.$EGRET_SUPPORT&&egret.log?egret.log(t):console.log(t))}function c(t,e,n,a,l){var i="";for(var o in e)i+=o+"="+e[o]+"&";""!=i&&(i=i.substr(0,i.length-1));var r=new egret.URLLoader;r.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(r.data);a(t)},this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){l()},this);var u=new egret.URLRequest(t);u.method=n,u.data=new egret.URLVariables(i),r.load(u)}e.$DEBUG_LOG=!1,e.$changeMethod=n,e.$getSpid=l;var p;e.$getChannelTag=i;var f;e.$isQQBrowser=o,e.$isTargetPlatform=r,e.$getOption=u,e.$log=s,e.setProxy=c}(e=t.utils||(t.utils={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(e){function n(e,n){if(t.$isRuntime)egret.localStorage.setItem(e,n);else try{window.localStorage.setItem(e,n)}catch(a){}}function a(e){if(t.$isRuntime)return egret.localStorage.getItem(e);try{return window.localStorage.getItem(e)}catch(n){return}}e.setItem=n,e.getItem=a}(e=t.localStorage||(t.localStorage={}))}(e=t.utils||(t.utils={}))}(nest||(nest={})),this.navigator?nest.utils.$isRuntime=!1:nest.utils.$isRuntime=!0;var nest;!function(t){var e;!function(e){function n(t,e,n){void 0===n&&(n=!1);var l="nest";n?(egret.ExternalInterface.addCallback(l,function(t){var n=JSON.parse(t);e(n.data)}),egret.ExternalInterface.call(l,JSON.stringify(t))):(f.push({data:t,callback:e}),a())}function a(){if(f.length){if(g)return;g=!0;var t=f.shift(),e="nest";egret.ExternalInterface.addCallback(e,function(e){var n=JSON.parse(e);t.callback(n.data),g=!1,a()}),egret.ExternalInterface.call(e,JSON.stringify(t.data))}}var l;!function(t){function e(t,e){var a={module:"core",action:"callCustomMethod",param:t};n(a,e)}function a(t){var e="nest_callback";egret.ExternalInterface.addCallback(e,function(e){var n=JSON.parse(e);t(n)})}t.callCustomMethod=e,t.addCallback=a}(l=e.core||(e.core={}));var i;!function(e){function a(e,a){var l={module:"user",action:"isSupport",param:e};if(t.utils.$isQQBrowser()){var i=function(t){t.logout=1,a.call(null,t)};n(l,i)}else n(l,a)}function l(t,e){var a={module:"user",action:"checkLogin",param:t};n(a,e)}function i(t,e){var a={module:"user",action:"login",param:t};n(a,e,!0)}function o(t,e){var a=egret.getOption("egret.runtime.nest");if(a>=4||"custom"==a){var l={module:"user",action:"logout",param:t};n(l,e)}else e({result:0})}function r(t,e){var a={module:"user",action:"getInfo",param:t};n(a,e)}e.isSupport=a,e.checkLogin=l,e.login=i,e.logout=o,e.getInfo=r}(i=e.user||(e.user={}));var o;!function(t){function e(t,e){var a={module:"iap",action:"pay",param:t};n(a,e)}t.pay=e}(o=e.iap||(e.iap={}));var r;!function(t){function e(t,e){var a={module:"share",action:"isSupport",param:t};n(a,e)}function a(t,e){e.call(null,{result:-2})}function l(t,e){var a={module:"share",action:"share",param:t};n(a,e,!0)}t.isSupport=e,t.setDefaultData=a,t.share=l}(r=e.share||(e.share={}));var u;!function(t){function e(t,e){var a={module:"social",action:"isSupport",param:t};n(a,e)}function a(t,e){var a={module:"social",action:"getFriends",param:t};n(a,e)}function l(t,e){var a={module:"social",action:"openBBS",param:t};n(a,e)}t.isSupport=e,t.getFriends=a,t.openBBS=l}(u=e.social||(e.social={}));var s;!function(t){function e(t,e){var n={create:0,update:0,report:0};e.call(null,n)}t.isSupport=e}(s=e.role||(e.role={}));var c;!function(t){function e(t,e){var n={invite:0};e.call(null,n)}t.isSupport=e}(c=e.invite||(e.invite={}));var p;!function(e){function a(t,e){var a={module:"app",action:"isSupport",param:t};n(a,e)}function l(t,e){var a={module:"app",action:"attention",param:t};n(a,e)}function i(t,e){var a={module:"app",action:"exitGame",param:t};n(a,e)}function o(t,e){var a={module:"app",action:"sendToDesktop",param:t};n(a,e)}function r(e,n){var a=t.utils.$API_DOMAIN+"user/getCustomInfo",l={appId:t.utils.$APP_ID,runtime:1,egretChanId:t.utils.$getSpid()};t.utils.setProxy(a,l,egret.URLRequestMethod.GET,function(t){var e=t.data;e.result=0,0==t.code?n.call(null,e):n.call(null,{result:-2})},function(){n.call(null,{result:-2})})}e.isSupport=a,e.attention=l,e.exitGame=i,e.sendToDesktop=o,e.getInfo=r}(p=e.app||(e.app={}));var f=[];e.callRuntime=n;var g=!1;e._getData=a}(e=t.runtime||(t.runtime={}))}(nest||(nest={}));var nest;!function(t){var e;!function(e){function n(t,e){var n;if(n=egret.localStorage.getItem("deviceid")){if(console.log("cm old local deviceid "+n),n.indexOf("{")>=0){var a=JSON.parse(n);t.postData.deviceid=a.did}else t.postData.deviceid=n;o(t.postData,e)}else{console.log("cm old CMPAY_EGRET.version "+CMPAY_EGRET.getVersion());var l=0==CMPAY_EGRET.getVersion()||0==CMPAY_EGRET.getVersion()?"getUid":"get_device_info",i=!1,r=function(n){i||(i=!0,console.log(n),t.postData.deviceid=n||egret.localStorage.getItem("deviceid")||"",o(t.postData,e))};egret.ExternalInterface.addCallback(l,function(t){if(console.log("cm old CMPAY_EGRET"),"get_device_info"==l)if(console.log("cm old get_device_info "+t),t){var e=JSON.parse(t);r(e.did)}else r(null);else r(t)}),egret.setTimeout(function(){console.log("cm old timeout"),r(null)},this,2e3),egret.ExternalInterface.call(l,"")}}function a(e){var n={},a=t.utils.$API_DOMAIN+"app/getInfo";n.egretChanId=t.utils.$getSpid(),n.egretGameId=t.utils.$APP_ID,n.debug=1,r(a,n,egret.URLRequestMethod.GET,function(t){e(t)})}function l(e,n,a){var l={};l.access_token=e.access_token,l.openid=e.openid;var i=t.utils.$API_DOMAIN+"game/"+t.utils.$getSpid()+"/"+t.utils.$APP_ID+"/";l.runtime=1,l.showGame=1,a&&(l.newLiebaoApi=1),r(i,l,egret.URLRequestMethod.GET,function(t){n(t)})}function i(n,a){var l=t.utils.$API_DOMAIN+"user/placeOrder",i={id:e.user.egretInfo.egretUserId,appId:t.utils.$APP_ID,time:Date.now(),runtime:1};for(var o in n)i[o]=n[o];r(l,i,egret.URLRequestMethod.GET,function(t){a(t)})}function o(t,e){var n="http://gclogin.liebao.cn/api/user/quick_register";r(n,t,egret.URLRequestMethod.POST,e)}function r(t,e,n,a){var l="";for(var i in e)l+=i+"="+e[i]+"&";""!=l&&(l=l.substr(0,l.length-1)),console.log("cm old solution ="+t+"?"+l);var o=new egret.URLLoader;o.addEventListener(egret.Event.COMPLETE,function(){console.log("cm old solution  ="+o.data);var t=JSON.parse(o.data);a(t)},this);var r=new egret.URLRequest(t);r.method=n,r.data=new egret.URLVariables(l),o.load(r)}e.callRuntime=n,e.loginBefore=a,e.loginAfter=l,e.payBefore=i}(e=t.cm||(t.cm={}))}(nest||(nest={})),function(t){var e;!function(e){var n;!function(e){function n(n,a){function l(t){e.egretInfo={egretUserId:t.data.id},t.data.result=t.status,a(t.data)}function i(e){1==e.ret?(e.access_token=e.ssid,egret.localStorage.getItem("deviceid")||egret.localStorage.setItem("deviceid",e.deviceid),t.cm.loginAfter(e,l,!1)):a({result:1})}function o(e){console.log("cm old loginHandler1"),console.log(JSON.stringify(e,null,4));var n={};n.access_token=e.cp.token,n.openid=e.user.openid,egret.localStorage.setItem("cm_token",n.access_token),console.log("cm old loginHandler2"),t.cm.loginAfter(n,l,!0)}function r(e){if(0==e.code){var l=e.data;u.client_id=l.client_id,u.client_secret=l.client_secret,u.redirect_uri=l.redirect_uri,t.cm.app.$initDesktop({Title:l.title,DetailUrl:l.detailUrl,PicUrl:l.picUrl}),CMGAME_EGRET.checkIsGameSDK(function(e,a){if(e){console.log("cm old checkIsGameSDK1");var r={clientId:l.client_id,clientSecret:l.client_secret,redirectUri:l.redirect_uri};egret.localStorage.getItem("cm_token"),console.log(JSON.stringify(r,null,4)),console.log("cm old checkIsGameSDK2"),CMGAME_EGRET.dispatchGameLoginData(r,o)}else console.log("cm old checkIsGameSDK2"),t.cm.callRuntime({module:"user",action:"checkLogin",param:n,postData:u},i)})}else a({result:1})}var u={};t.cm.loginBefore(r)}function a(e,n){var a={module:"user",action:"login",param:e};t.cm.callRuntime(a,n)}function l(t,e){console.log("cm old nest isSupport start"),e({getInfo:0,loginType:null,loginTypes:null,result:0})}function i(e,n){t.runtime.user.logout(e,n)}e.checkLogin=n,e.login=a,e.isSupport=l,e.logout=i}(n=e.user||(e.user={}))}(e=t.cm||(t.cm={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(e){function n(e,n){var l=0,i=-1,o=-2;t.payBefore(e,function(t){if(0==t.code){a&&(CMPAY_EGRET.on("cmpay_order_complete",function(t){console.log("cm old solution cmpay_order_complete  "+JSON.stringify(t,null,4)),n(1==t.success?{result:l}:2==t.ret?{result:i}:{result:o})}),a=!1);var e={access_token:t.data.access_token,client_id:t.data.client_id,product_id:t.data.product_id,unit:t.data.unit,payload:t.data.payload,notify_url:t.data.notify_url,money:t.data.money,order_name:t.data.order_name,game_icon:t.data.game_icon,game_name:t.data.game_name};CMPAY_EGRET.purchase(e)}else n({result:o})})}var a=!0;e.pay=n}(e=t.iap||(t.iap={}))}(e=t.cm||(t.cm={}))}(nest||(nest={})),function(t){var e;!function(e){var n;!function(e){function n(e,n){t.runtime.social.isSupport(e,n)}function a(e,n){t.runtime.social.getFriends(e,n)}function l(e,n){t.runtime.social.openBBS(e,n)}e.isSupport=n,e.getFriends=a,e.openBBS=l}(n=e.social||(e.social={}))}(e=t.cm||(t.cm={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t,e){e({result:0,share:0})}t.isSupport=e}(e=t.share||(t.share={}))}(e=t.cm||(t.cm={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t){l=t,egret.ExternalInterface.call("save_shortcut_info",JSON.stringify({token:String(Math.random()),value:JSON.stringify(t)}))}function n(t,e){e(0!=CMPAY_EGRET.getVersion()&&!isNaN(CMPAY_EGRET.getVersion())&&CMPAY_EGRET.getVersion()>301030?{result:0,sendToDesktop:1,attention:0}:{result:0,sendToDesktop:0,attention:0})}function a(t,e){l?(egret.ExternalInterface.call("push_icon",JSON.stringify({title:l.Title,detailUrl:l.DetailUrl,picUrl:l.PicUrl})),e({result:0})):e({result:-1})}var l;t.$initDesktop=e,t.isSupport=n,t.sendToDesktop=a}(e=t.app||(t.app={}))}(e=t.cm||(t.cm={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t,e){var n={create:0,update:0,report:0};e.call(null,n)}t.isSupport=e}(e=t.role||(t.role={}))}(e=t.cm||(t.cm={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t,e){var n={invite:0};e.call(null,n)}t.isSupport=e}(e=t.invite||(t.invite={}))}(e=t.cm||(t.cm={}))}(nest||(nest={}));var nest;!function(t){var e;!function(e){function n(t,e,n,a){var l="";for(var i in e)l+=i+"="+e[i]+"&";""!=l&&(l=l.substr(0,l.length-1)),console.log("[Nest]qq hall send : "+t+"?"+l);var o=new egret.URLLoader;o.addEventListener(egret.Event.COMPLETE,function(){console.log("[Nest]qq hall get data : "+o.data);var t=JSON.parse(o.data);a(t)},this);var r=new egret.URLRequest(t);r.method=n,r.data=new egret.URLVariables(l),o.load(r)}function a(a,l){var i=t.utils.$API_DOMAIN+"user/placeOrder",o={id:e.userId,appId:t.utils.$APP_ID,time:Date.now(),openid:e.OpenId,openkey:e.OpenKey,paytoken:e.payToken,runtime:1};for(var r in a)o[r]=a[r];n(i,o,egret.URLRequestMethod.GET,function(t){l(t)})}function l(t){var e=JSON.stringify(t);egret.ExternalInterface.call("HALL_EGRET_MSG_FROM",e)}function i(){egret.ExternalInterface.addCallback("HALL_EGRET_MSG_TO",function(a){var i=JSON.parse(a);switch(i.msgType){case e.login_callback_type:if(null==i.accessToken){if(e.loginNum++,e.loginNum>=3){var o={result:-1,token:void 0};return e.loginCallback.call(null,o),void(e.loginCallback=null)}var r="OpenId/OpenKey 为空";return l({msgType:e.login_back_call_type,msgVersion:e.version,errorID:1,loginInfoStr:r}),void l({msgType:e.login_call_type,msgVersion:e.version})}if(e.loginCallback){e.gameType=i.msgType,e.gameVersion=i.msgVersion,e.OpenId=i.openId,e.OpenKey=i.accessToken,e.enterType=i.enterType,e.enterId=i.enterId,e.payToken=i.payToken;var r="登录成功";l({msgType:e.login_back_call_type,msgVersion:e.version,errorID:0,loginInfoStr:r});var u=t.utils.$API_DOMAIN+"game/"+t.utils.$getSpid()+"/"+t.utils.$APP_ID,s={};s.openkey=e.OpenKey,s.openid=e.OpenId,s.paytoken=e.payToken,s.runtime=1,s.showGame=1,n(u,s,egret.URLRequestMethod.GET,function(t){var n=t.data;e.userId=n.id,e.loginCallback.call(null,n),e.loginCallback=null})}break;case e.pay_callback_type:if(e.payCallback){var c=-1;switch(i.payState){case-1:case 1:case 2:e.payOrderInfo=null,e.payCallback.call(null,{result:c,status:c}),e.payCallback=null;break;case 0:e.iap.repay()}}break;case e.share_callback_type:if(e.shareCallback){var c=i.errorid;e.shareCallback.call(null,{result:c,status:c}),e.shareCallback=null}}})}e.login_call_type=102,e.login_back_call_type=100,e.pay_call_type=101,e.share_call_type=104,e.login_callback_type=200,e.pay_callback_type=201,e.share_callback_type=204,e.loginCallback=null,e.payCallback=null,e.shareCallback=null,e.version="V1.0.0",e.loginNum=0,e.payBefore=a,e.callHall=l,e.init=i}(e=t.qqhall||(t.qqhall={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(e){function n(t,e){var n=0,a={status:n,result:n,checkLogin:0,login:1,logout:0,getInfo:0};e.call(null,a)}function a(t,e){var n=-1,a={status:n,result:n,loginType:void 0,token:void 0};e.call(null,a)}function l(e,n){t.loginCallback=n,t.callHall({msgType:t.login_call_type,msgVersion:t.version})}e.isSupport=n,e.checkLogin=a,e.login=l}(e=t.user||(t.user={}))}(e=t.qqhall||(t.qqhall={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(e){function n(e,n){t.payOrderInfo||(t.payOrderInfo=e,t.payBefore(e,function(e){e=e.data,0==e.code?n.call(null,{result:0,status:0}):(t.payCallback=n,t.callHall({msgType:t.pay_call_type,msgVersion:"V1.0.0",acctType:"",zoneId:"",payValue:e.qCoins,isCanChange:!1}))}))}function a(){if(t.payOrderInfo){var e=t.payOrderInfo,n=t.payCallback;t.payBefore(e,function(t){t=t.data;var e=t.status;n.call(null,{result:e,status:e})}),t.payOrderInfo=null,t.payCallback=null}}e.pay=n,e.repay=a}(e=t.iap||(t.iap={}))}(e=t.qqhall||(t.qqhall={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t,e){var n=0,a={status:n,result:n,attention:0,sendToDesktop:0,exitGame:1};e.call(null,a)}function n(t){var e=0,n={status:e,result:e};t.call(null,n)}function a(t,e){}function l(t,e){}t.isSupport=e,t.exitGame=n,t.attention=a,t.sendToDesktop=l}(e=t.app||(t.app={}))}(e=t.qqhall||(t.qqhall={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(e){function n(t,e){var n=0,a={status:n,result:n,share:1};e.call(null,a)}function a(e,n){t.shareCallback=n,t.callHall({msgType:t.share_call_type,msgVersion:"V1.0.0",title:e.title,summary:e.description,imageLocalUrl:"",targetUrl:e.url})}e.isSupport=n,e.share=a}(e=t.share||(t.share={}))}(e=t.qqhall||(t.qqhall={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t,e){var n=0,a={status:n,result:n,getFriends:0,openBBS:0};e.call(null,a)}function n(t,e){}function a(t,e){}t.isSupport=e,t.getFriends=n,t.openBBS=a}(e=t.social||(t.social={}))}(e=t.qqhall||(t.qqhall={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t,e){var n={create:0,update:0,report:0};e.call(null,n)}t.isSupport=e}(e=t.role||(t.role={}))}(e=t.qqhall||(t.qqhall={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t,e){var n={invite:0};e.call(null,n)}t.isSupport=e}(e=t.invite||(t.invite={}))}(e=t.qqhall||(t.qqhall={}))}(nest||(nest={}));var nest;!function(t){var e;!function(e){function n(e,n,a,l){var i="";for(var o in n)i+=o+"="+encodeURIComponent(n[o])+"&";""!=i&&(i=i.substr(0,i.length-1));for(var r="[Nest]qq hall2 send : "+e+"?"+i,u=0;u<Math.ceil(r.length/450);u++)t.utils.$log(r.slice(450*u,450*(u+1)));var s=new egret.URLLoader;s.addEventListener(egret.Event.COMPLETE,function(){t.utils.$log("[Nest]qq hall2 get data : "+s.data);var e=JSON.parse(s.data);l(e)},this);var c=new egret.URLRequest(e);c.method=a,c.data=new egret.URLVariables(i),s.load(c)}function a(e,a){var l=t.utils.$API_DOMAIN+"user/placeOrder",i={id:O,appId:t.utils.$APP_ID,time:Date.now(),qbopenkey:q,runtime:1};for(var o in e)i[o]=e[o];n(l,i,egret.URLRequestMethod.GET,function(t){a(t)})}function l(e,a){var l=t.utils.$API_DOMAIN+"pay/"+t.utils.$getSpid()+"/"+t.utils.$APP_ID;n(l,e,egret.URLRequestMethod.GET,function(t){a(t)})}function i(e){var n=JSON.stringify(e);t.utils.$log("call hall : "+n),egret.ExternalInterface.call("HALL_EGRET_MSG_FROM",n)}function o(t){ee=t,i({msgType:w,appid:p,appsig:f,appsigData:g,qbopenid:P,msgVersion:le})}function r(t){ne=t,i({msgType:V,appid:p,appsig:f,msgVersion:le})}function u(t){te=t,i({msgType:B,appid:p,qbopenid:P,refreshToken:"",msgVersion:le})}function s(t){ae=t,i({msgType:x,appid:p,appsig:f,appsigData:g,qbopenid:"",qbopenkey:"",msgVersion:le})}function c(){egret.ExternalInterface.addCallback("HALL_EGRET_MSG_TO",function(e){t.utils.$log("get hall data : "+e);for(var a=0;a<Math.ceil(e.length/450);a++)t.utils.$log(e.slice(450*a,450*(a+1)));var i,u=JSON.parse(e);switch(u.msgType){case J:if(W)if(i=u.result,0==i){S=u.msgType,_=u.msgVersion,y=u.openId,k=u.accessToken,I=u.enterType,T=u.enterId,E=u.payToken,P=u.qbopenid,q=u.qbopenkey,$=u.nickName,D=u.avatarUrl;var s=function(){if(W){var e=t.utils.$API_DOMAIN+"game/"+t.utils.$getSpid()+"/"+t.utils.$APP_ID,a={};a.openId=y,a.accessToken=k,a.payToken=E,a.qbopenid=P,a.qbopenkey=q,a.nickName=$,a.avatarUrl=D,a.balance=ie,a.gen_balance=d,a.first_save=v,a.save_amt=m,a.pf=b,a.baseinfo=JSON.stringify(h),a.runtime=1,n(e,a,egret.URLRequestMethod.GET,function(t){var e=t.data;O=e.id,W.call(null,e),W=null})}},c=!1,p=!1;o(function(){c=!0,c&&p&&s()}),r(function(){p=!0,c&&p&&s()})}else W.call(null,{result:-2}),W=null;break;case F:if(X){if(0!=A){var f={};f.realSaveNum=u.realSaveNum,f.orderno=u.orderno,f.customMeta=G,l(f,function(t){0==t.code?(R=null,X.call(null,{result:0,status:0}),X=null,o(null)):(R=null,X.call(null,{result:-2,status:-2}),X=null)});break}2==u.resultCode?(R=null,X.call(null,{result:-1,status:-1}),X=null):0==u.resultCode?o(function(){ue.repay()}):(R=null,X.call(null,{result:-2,status:-2}),X=null)}break;case Y:Z&&(i=u.errorid,Z.call(null,{result:i,status:i}),Z=null);break;case K:0==u.result&&(q=u.qbopenkey),te&&(te.call(null),te=null);break;case Q:0==u.result&&(ie=u.balance,d=u.gen_balance,v=u.first_save,m=u.save_amt),ee&&(ee.call(null),ee=null);break;case j:0==u.result&&(h=u.baseinfo),ne&&(ne.call(null),ne=null);break;case z:1==u.loginType?oe.push("qq"):2==u.loginType?oe.push("wx"):3==u.loginType&&(oe.push("qq"),oe.push("wx")),ae&&(ae.call(null),ae=null)}})}var p,f,g,d,v,m,h,S,_,y,k,I,T,E,P,q,$,D,O,b,R,A,L,M,C,G,N=100,U=101,H=104,B=106,w=107,V=108,x=109,J=200,F=201,Y=204,K=206,Q=207,j=208,z=209,W=null,X=null,Z=null,te=null,ee=null,ne=null,ae=null,le="1.0.0",ie=0,oe=[];e.init=c;var re;!function(e){function a(t,e){s(function(){var t=0,n={status:t,result:t,loginType:oe,checkLogin:0,login:1,logout:0,getInfo:0};e.call(null,n)})}function l(e,a){var l=t.utils.$API_DOMAIN+"app/getSignInfo",i={egretChanId:t.utils.$getSpid(),appId:t.utils.$APP_ID};n(l,i,egret.URLRequestMethod.GET,function(t){p=t.data.appid,f=t.data.appsig,g=t.data.appsigdata;var e=-2,n={status:e,result:e,loginType:void 0,token:void 0};a.call(null,n)})}function o(t,e){W=e,b=t.loginType,i({msgType:N,appid:p,appsig:f,appsigData:g,loginType:b,msgVersion:le})}e.isSupport=a,e.checkLogin=l,e.login=o}(re=e.user||(e.user={}));var ue;!function(t){function e(t,e){R||(R=t,u(function(){a(t,function(t){t=t.data,L=t.payValue,C=t.payInfo,M=t.payItem,G=t.customMeta,X=e,A=L>ie?0:1,l()})}))}function n(){L>ie?X&&(R=null,X.call(null,{result:-2,status:-2}),X=null):(A=1,l())}function l(){i({msgType:U,msgVersion:le,payType:A,appid:p,appsig:f,appsigData:g,payItem:M,payInfo:C,reqTime:Date.now(),customMeta:G,payValue:L,qbopenid:P,qbopenkey:q,isCanChange:!1})}t.pay=e,t.repay=n}(ue=e.iap||(e.iap={}));var se;!function(t){function e(t,e){var n=0,a={status:n,result:n,attention:0,sendToDesktop:0,exitGame:0};e.call(null,a)}function n(t,e){}function a(t,e){}function l(t,e){}t.isSupport=e,t.exitGame=n,t.attention=a,t.sendToDesktop=l}(se=e.app||(e.app={}));var ce;!function(t){function e(t,e){var n=0,a={status:n,result:n,share:1};e.call(null,a)}function n(t,e){Z=e,u(function(){i({msgType:H,msgVersion:le,appid:p,appsig:f,appsigData:g,qbopenid:P,qbopenkey:q,title:t.title,summary:t.description,imageLocalUrl:t.img_url,img_title:t.img_title,cus_txt:"",targetUrl:t.url})})}t.isSupport=e,t.share=n}(ce=e.share||(e.share={}));var pe;!function(t){function e(t,e){var n=0,a={status:n,result:n,getFriends:0,openBBS:0};e.call(null,a)}function n(t,e){}function a(t,e){}t.isSupport=e,t.getFriends=n,t.openBBS=a}(pe=e.social||(e.social={}));var fe;!function(t){function e(t,e){var n={create:0,update:0,report:0};e.call(null,n)}t.isSupport=e}(fe=e.role||(e.role={}));var ge;!function(t){function e(t,e){var n={invite:0};e.call(null,n)}t.isSupport=e}(ge=e.invite||(e.invite={}))}(e=t.qqhall2||(t.qqhall2={}))}(nest||(nest={}));var nest;!function(t){var e;!function(e){e.uid=void 0;var n;!function(e){function n(e,n){var a=[];t.utils.$isQQBrowser()&&(a.push("qq"),a.push("wx"));var l={result:0,loginType:a,loginTypes:void 0,getInfo:0};n.call(null,l)}function a(e,n){var a=function(e){t.h5.uid=e.id;var a=e.status;t.h5.uid&&(a=0);var l={result:a,token:e.token};n.call(null,l)};EgretH5Sdk.checkLogin(a,null)}function l(e,n){var a=function(e){t.h5.uid=e.id;var a=e.status;t.h5.uid&&(a=0);var l={result:a,token:e.token};n.call(null,l)};EgretH5Sdk.login(a,null,e.loginType)}function i(t,e){var n=function(t){var n=t.status,a=1==n?0:1;e.call(null,{result:a})};EgretH5Sdk.logout(n,null)}e.isSupport=n,e.checkLogin=a,e.login=l,e.logout=i}(n=e.user||(e.user={}));var a;!function(e){function n(e,n){t.h5.uid&&(e.appId=t.utils.$APP_ID,e.uId=t.h5.uid,EgretH5Sdk.pay(e,function(t){n(t)},this))}e.pay=n}(a=e.iap||(e.iap={}));var l;!function(e){function n(e,n){var a=function(t){var e=t.status,a={share:e};n.call(null,a)};EgretH5Sdk.isOpenShare(t.utils.$APP_ID,t.h5.uid,a,null)}function a(e,n){var a=function(t){var e=t.status;0==e?e=-1:1==e&&(e=0);var a={status:e,result:e};n.call(null,a)};EgretH5Sdk.share(t.utils.$APP_ID,t.h5.uid,e,a,null)}e.isSupport=n,e.share=a}(l=e.share||(e.share={}));var i;!function(e){function n(e,n){var a=function(t){var e=t.status,a={invite:e};n.call(null,a)};EgretH5Sdk.isOpenInvite(t.utils.$APP_ID,t.h5.uid,a,null)}function a(e,n){var a=function(t){var e=t.status;0==e?e=-1:1==e&&(e=0);var a={status:e,result:e};n.call(null,a)};EgretH5Sdk.invite(t.utils.$APP_ID,t.h5.uid,e,a,null)}e.isSupport=n,e.invite=a}(i=e.invite||(e.invite={}));var o;!function(t){function e(t,e){var n={create:0,update:0,report:0};e.call(null,n)}t.isSupport=e}(o=e.role||(e.role={}));var r;!function(t){function e(t,e){e.call(null,{result:0,getFriends:0,openBBS:0})}function n(t,e){}function a(t,e){}t.isSupport=e,t.getFriends=n,t.openBBS=a}(r=e.social||(e.social={}));var u;!function(e){function n(e,n){var a=function(t){var e=t.status,a={attention:e};n.call(null,a)};EgretH5Sdk.isOpenAttention(t.utils.$APP_ID,t.h5.uid,a,null)}function a(e,n){EgretH5Sdk.attention(t.utils.$APP_ID,t.h5.uid),n.call(null,{result:0})}function l(t,e){e.call(null,{result:-1})}function i(e,n){var a=function(t){var e={result:0,contact:t.contact};n.call(null,e)};EgretH5Sdk.getCustomInfo(t.utils.$APP_ID,t.h5.uid,a,null)}e.isSupport=n,e.attention=a,e.sendToDesktop=l,e.getInfo=i}(u=e.app||(e.app={}))}(e=t.h5||(t.h5={}))}(nest||(nest={})),function(t){var e;!function(t){var e;!function(t){function e(t,e){var n={result:0,loginType:void 0,loginTypes:void 0,getInfo:0};EgretH5Sdk.getLoginType({},function(t){n.loginType=t.loginType,n.loginTypes=t.loginTypes,e.call(null,n)})}function n(t,e){EgretH5Sdk.checkLogin(t,e)}function a(t,e){EgretH5Sdk.login(t,e)}function l(t,e){EgretH5Sdk.logout(t,e)}function i(t,e){e.call(null,{result:-2})}t.isSupport=e,t.checkLogin=n,t.login=a,t.logout=l,t.getInfo=i}(e=t.user||(t.user={}));var n;!function(t){function e(t,e){EgretH5Sdk.pay(t,e)}t.pay=e}(n=t.iap||(t.iap={}));var a;!function(t){function e(t,e){var n=function(t){var n=t.result,a={share:n,msg:t.msg};e.call(null,a)};EgretH5Sdk.isSupportShare({},n)}function n(t,e){t.imgUrl=t.img_url,EgretH5Sdk.setShareDefaultData(t,e)}function a(t,e){t.imgUrl=t.img_url,EgretH5Sdk.share(t,e)}t.isSupport=e,t.setDefaultData=n,t.share=a}(a=t.share||(t.share={}));var l;!function(t){function e(t,e){var n=function(t){var n=t.result,a={invite:n,msg:t.msg};e.call(null,a)};EgretH5Sdk.isSupportInvite({},n)}function n(t,e){t.imgUrl=t.img_url,EgretH5Sdk.invite(t,e)}t.isSupport=e,t.invite=n}(l=t.invite||(t.invite={}));var i;!function(t){function e(t,e){var n,a,l,i=function(t){n=t.result,EgretH5Sdk.isSupportUpdateRole({},o)},o=function(t){a=t.result,EgretH5Sdk.isSupportReportRole({},r)},r=function(t){l=t.result;var i={create:n,update:a,report:l,msg:t.msg};e.call(null,i)};EgretH5Sdk.isSupportCreateRole({},i)}function n(t,e){EgretH5Sdk.createRole(t,e)}function a(t,e){EgretH5Sdk.updateRole(t,e)}function l(t,e){EgretH5Sdk.reportRole(t,e)}t.isSupport=e,t.create=n,t.update=a,t.report=l}(i=t.role||(t.role={}));var o;!function(t){function e(t,e){var n,a=function(t){n=t.result;var a={result:0,getFriends:0,openBBS:n};e.call(null,a)};EgretH5Sdk.isSupportAttention({},a)}function n(t,e){e.call(null,{result:-2})}function a(t,e){EgretH5Sdk.openBBS(t,e)}t.isSupport=e,t.getFriends=n,t.openBBS=a}(o=t.social||(t.social={}));var r;!function(t){function e(t,e){var n,a,l=function(t){n=t.result,EgretH5Sdk.isSupportSendToDesktop({},i)},i=function(t){a=t.result;var l={attention:n,getInfo:1,exitGame:0,sendToDesktop:a};e.call(null,l)};EgretH5Sdk.isSupportAttention({},l)}function n(t,e){EgretH5Sdk.attention({},e)}function a(t,e){EgretH5Sdk.sendToDesktop(t,e)}function l(t,e){e.call(null,{result:-2})}function i(t,e){EgretH5Sdk.getCustomInfo({},e)}t.isSupport=e,t.attention=n,t.sendToDesktop=a,t.exitGame=l,t.getInfo=i}(r=t.app||(t.app={}))}(e=t.h5_2||(t.h5_2={}))}(nest||(nest={})),nest.core=nest.core||{},nest.core.addCallback=function(){},nest.core.startup=function(t,e){try{new egret.HashObject,nest.utils.$EGRET_SUPPORT=!0}catch(n){nest.utils.$EGRET_SUPPORT=!1}var a="http://api.egret-labs.org/v2/";if(nest.utils.$APP_ID=t.egretAppId,nest.utils.$DEBUG_LOG=t.debug,nest.utils.$isRuntime)if((nest.utils.$isQQBrowser()||nest.utils.$isTargetPlatform(10080)||nest.utils.$isTargetPlatform(10835)||nest.utils.$isTargetPlatform(20546))&&(a="http://api.gz.1251278653.clb.myqcloud.com/v2/"),nest.utils.$API_DOMAIN=a,nest.core.callCustomMethod=nest.runtime.core.callCustomMethod,nest.utils.$isTargetPlatform(10044)||!nest.utils.$getOption("egret.runtime.nest")){egret_native.setOption("channelTag","liebao"),CMPAY_DEBUG=!1;var l;l=85==nest.utils.$APP_ID||88==nest.utils.$APP_ID?10044:18287,egret_native.setOption("egret.runtime.spid",l),nest.utils.$spid=l,nest.utils.$changeMethod("cm")}else if(nest.utils.$isTargetPlatform(10835)||nest.utils.$isTargetPlatform(20546)){var l;66==nest.utils.$APP_ID||86==nest.utils.$APP_ID?(nest.qqhall.init(),nest.utils.$changeMethod("qqhall")):(nest.qqhall2.init(),nest.utils.$changeMethod("qqhall2"))}else nest.utils.$changeMethod("runtime");else{var i=nest.utils.$getOption("egretServerDomain");i?a=i+"/":nest.utils.$API_DOMAIN=a;var o=nest.utils.$getOption("egretSdkDomain");if(o||(o=nest.utils.$API_DOMAIN),2==t.version){nest.utils.$changeMethod("h5_2");var r=o+"/misc/scripts/egreth5sdk.js?v="+(Date.now()+Math.random()),u=document.createElement("script");return u.hasOwnProperty("async")&&(u.async=!1),u.src=r,u.id="egreth5sdk",u.addEventListener("load",function s(){this.removeEventListener("load",s,!1),EgretH5Sdk.init({},e)},!1),u.addEventListener("error",function c(){u.parentNode.removeChild(u),this.removeEventListener("error",c,!1),e({result:-2})},!1),void document.head.appendChild(u)}nest.utils.$changeMethod("h5")}e({result:0})};