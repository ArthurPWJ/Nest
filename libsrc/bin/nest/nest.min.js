if(egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(10044==egret_native.getOption("egret.runtime.spid")||!egret_native.getOption("egret.runtime.nest")))var CMPAY_EGRET=function(){function e(){}function t(){for(var e=r.length,t=0;e>t;++t)r[t]();r.length=0}function n(){function e(e){var t;try{t=JSON.stringify(e).replace(/"/g,"`")}catch(n){return!1}return console.log("ssss:runtime-send:"+t),egret.ExternalInterface.call("newWebViewInstance",JSON.stringify({action:"callWebViewMethod",data:{methodName:"egretRuntimeOnMessage",paramStr:t}})),!0}function n(t,n){var a;if(n&&"object"==typeof n&&"number"==typeof(a=n.length))for(var o="on"===t,r="off"===t,s=0;a>s;++s){var l=n[s];if("function"==typeof l){var c=String(Math.random());r?delete i[c]:i[c]={isPersist:o,fn:l},n[s]={token:c}}}e({type:"cmpay_invoke",args:n,method:t})}function a(e){for(var t=[],n=e.length,a=0;n>a;++a)t.push(e[a]);return t}var r=!1;"boolean"==typeof CMPAY_DEBUG?r=CMPAY_DEBUG:CMPAY_DEBUG=!1,console.log("ssss:initOld:"+r);var i={};egret.ExternalInterface.addCallback("webview_to_runtime_js_data",function(e){console.log("ssss:runtime-recv:"+e);var n;try{n=JSON.parse(e)}catch(a){return}if(n&&n.type)switch(n.type){case"cmpay_loaded":return o.isReady=!0,void t();case"cmpay_invoke":var r,s=n.token;return void(s&&i.hasOwnProperty(s)&&i[s]&&"function"==typeof(r=i[s].fn)&&(i[s].isPersist||delete i[s],r.apply(null,n.args)))}});var s="http://game.liebao.cn/game/pay/part/cmpay-runtime-proxy-egret.html?";s+="_t="+Math.floor(Date.now()/3600/24/1e3),r&&(s+="&debug=1"),egret.ExternalInterface.call("newWebViewInstance",JSON.stringify({action:"createHiddenWebView",data:{url:s}})),console.log("ssss:runtime-create:"+s);for(var l=["on","off","fire","purchase"],c=l.length-1;c>-1;--c)!function(e){o[e]=function(){n(e,a(arguments))}}(l[c])}function a(){function e(e,t){var n=String(Math.random());egret.ExternalInterface.addCallback("wsj_pay",function(e){var a;try{a=JSON.parse(e)}catch(o){}if(a&&a.token===n){var r;try{r=JSON.parse(a.response)}catch(o){}t(r)}}),console.log("tttt:wsj_pay:"+JSON.stringify({token:n,request:e})),egret.ExternalInterface.call("wsj_pay",JSON.stringify({token:n,request:JSON.stringify(e)}))}function n(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var a=e[n],o=typeof a;("number"===o||"string"===o||"boolean"===o)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}return t.join("&")}function a(e,t){var a=new egret.URLLoader,o=new egret.URLRequest;e.method&&"post"===e.method.toLowerCase()&&(o.method=egret.URLRequestMethod.POST);var r="";e.data&&(r="string"==typeof e.data?e.data:n(e.data),o.data=new egret.URLVariables(r)),o.url=e.url,a.dataFormat=egret.URLLoaderDataFormat.TEXT,a.addEventListener(egret.Event.COMPLETE,function(){console.log("tttt:netreq:complete:"+a.data),t(a.data)}),console.log("tttt:netreq:"+o.url+":"+r),a.load(o)}function r(e,t){console.log("ssss:placeOrderProxy:"+JSON.stringify(e));var o=e.data&&e.data.access_token;if(o)if(32===o.length||"sdk"===o.slice(0,3)){var r={token:o,method:e.pay_method,dev:e.debug?1:null},i=e.data;for(var s in i)i.hasOwnProperty(s)&&"access_token"!==s&&(r[s]=i[s]);a({method:"POST",url:"http://gclogin.liebao.cn/api/native/order/pay",data:r},t)}else a({method:"POST",url:"http://gc.liebao.cn/pay/topay.php",data:{method:e.pay_method,args:n(e.data),dev:e.debug?1:null}},t);else t(!1,-1,'{"msg":"Token not provided."}')}function i(e,t){r(e,function(e){var n,a=!1,o="Unkown error";if(e){e=e.replace(/"transaction_id":(\d+)/,'"transaction_id":"$1"');try{n=JSON.parse(e),a=!0}catch(r){o="Empty response"}}var i=a&&n&&n.data&&n.data.args&&n.data.args.goodsTokenUrl&&1===n.ret;if(i){var s=n.data.args.goodsTokenUrl;o=s?"ok":"Empty goods token url"}t(i,i?0:n?n.ret:-1,o,n)})}var s=!1;"boolean"==typeof CMPAY_DEBUG?s=CMPAY_DEBUG:CMPAY_DEBUG=!1,console.log("ssss:initNew:"+s);var l={};o.on=function(e,t){var n;n=l.hasOwnProperty(e)?l[e]:l[e]=[],n.push(t)},o.off=function(e,t){var n;l.hasOwnProperty(e)&&(n=l[e]);for(var a=n.length,o=0;a>o;++o)n[o]===t&&n.splice(o,1)},o.fire=function(e){if(l.hasOwnProperty(e))for(var t=[].slice.call(arguments,1),n=l[e],a=n.length,o=n.slice(),r=0;a>r;++r){var i=o[r];try{i.apply(null,t)}catch(s){}}},o.isReady=!0,o.purchase=function(t){console.log("ssss:purchase:"+JSON.stringify(t)),i({pay_method:"wsjpay/sdk",data:t,debug:"undefined"!=typeof t.debug?t.debug:s},function(t,n,a,r){o.fire("cmpay_order_placed",{type:"cmpay_order_placed",transaction_id:r&&r.data?r.data.transaction_id:null,ret:n,msg:a,success:t,response:r}),t?e(r.data.args,function(e){var t=e&&"number"==typeof e.resultCode?e.resultCode:-99,n=e&&0===e.resultCode;o.fire("cmpay_order_complete",{type:"cmpay_order_complete",transaction_id:r.data.transaction_id,ret:t,success:n,payed:n,paid:n,wsjResponse:e})}):o.fire("cmpay_order_complete",{type:"cmpay_order_complete",transaction_id:r&&r.data?r.data.transaction_id:null,ret:-99,success:!1,payed:!1,paid:!1,wsjResponse:null})})},t()}var o={on:e,off:e,ready:e,isReady:!1,fire:e,purchase:e,getVersion:e,type:"egret_runtime"},r=[];o.ready=function(e){o.isReady?e():r.push(e)};var i=!1;o.getVersion=function(){return i};var s=egret.setTimeout(function(){i===!1?n():a()},null,100);return egret.ExternalInterface.addCallback("get_game_sdk_version",function(e){egret.clearTimeout(s),console.log("ssss:get_game_sdk_version:"+JSON.stringify(arguments)),i=e,a()}),egret.ExternalInterface.call("get_game_sdk_version",""),o}();if(egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(10044==egret_native.getOption("egret.runtime.spid")||!egret_native.getOption("egret.runtime.nest")))var CMGAME_EGRET=function(){function e(e,t){var n=!1,a=!1,o=egret.setTimeout(function(){a||(a=!0,t(n))},null,e);egret.ExternalInterface.addCallback("get_game_sdk_version",function(e){console.log("ssss:get_game_sdk_version"+JSON.stringify(arguments)),egret.clearTimeout(o),a||(a=!0,n=e,t(n))}),egret.ExternalInterface.call("get_game_sdk_version","")}var t={};return t.checkIsGameSDK=function(){var t=!1,n=!0,a=-1,o=!1,r=[];return function(i){if(t)egret.setTimeout(function(){i(n,a)},null,1);else if(r.push(i),!o){o=!0;var s=function(){t=!0,egret.setTimeout(function(){console.log("sssstttt:CMGAME.checkIsGameSDK call listeners"),o=!1;for(var e=0;e<r.length;++e)try{r[e](n,a)}catch(t){console.log(t)}r.length=0},null,1)};console.log("sssstttt:get_game_sdk_version()"),e(1e4,function(e){console.log("sssstttt:get_game_sdk_version():"+JSON.stringify(arguments)),e&&!isNaN(e)&&(a=e),s()})}}}(),t.saveShortcutInfo=function(e,t){egret.ExternalInterface.call("save_shortcut_info",JSON.stringify({token:String(Math.random()),value:JSON.stringify(e)}))},t.pushIcon=function(e,t){e.title=e.Title,e.detailUrl=e.DetailUrl,e.picUrl=e.PicUrl,egret.ExternalInterface.call("push_icon",JSON.stringify(e))},t.dispatchGameLoginData=function(){var e;return egret.ExternalInterface.addCallback("dispatchGameLoginData",function(t){if(console.log("sssstttt:dispatchGameLoginData:callback:"+t),e){var n=!1;if("string"==typeof t)try{n=JSON.parse(t)}catch(a){}else n=t;e(n)}}),function(t,n){var a=e;e=function(t){e=a,n(t)},egret.ExternalInterface.call("dispatchGameLoginData",JSON.stringify(t))}}(),t.getGameSDKDeviceID=function(){throw"Method not exists, use CMGAME_LAYA.getGameSDKDeviceIDAsync() instead."},t.getGameSDKDeviceIDAsync=function(e){var t;return egret.ExternalInterface.addCallback("get_device_info",function(e){if(t){var n=!1;if("string"==typeof e)try{n=JSON.parse(e)}catch(a){}else n=e;t(n)}}),function(e){var n=t;t=function(a){t=n,e(a)},egret.ExternalInterface.call("get_device_info","")}}(),t}();var nest;!function(e){var t;!function(t){function n(e,n){null!=e.egretAppId&&(t.appId=e.egretAppId),n({result:0})}function a(t,n){var a={module:"core",action:"callCustomMethod",param:t};e.callRuntime(a,n)}t.appId=parseInt(egret.getOption("appId")),t.startup=n,t.callCustomMethod=a}(t=e.core||(e.core={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(t,n){var a={module:"user",action:"checkLogin",param:t};e.callRuntime(a,n)}function a(t,n){var a={module:"user",action:"login",param:t};e.callRuntime(a,n,!0)}function o(t,n){var a=egret_native.getOption("egret.runtime.nest");if(a>=4||"custom"==a){var o={module:"user",action:"logout",param:t};e.callRuntime(o,n)}else n({result:0})}function r(t){var n={module:"user",action:"isSupport"};e.callRuntime(n,t)}function i(t){var n={module:"user",action:"getInfo"};e.callRuntime(n,t)}t.checkLogin=n,t.login=a,t.logout=o,t.isSupport=r,t.getInfo=i}(t=e.user||(e.user={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(t,n){var a={module:"iap",action:"pay",param:t};e.callRuntime(a,n)}t.pay=n}(t=e.iap||(e.iap={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(t){var n={module:"share",action:"isSupport"};e.callRuntime(n,t)}function a(t,n){var a={module:"share",action:"share",param:t};e.callRuntime(a,n,!0)}t.isSupport=n,t.share=a}(t=e.share||(e.share={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(t){var n={module:"social",action:"isSupport"};e.callRuntime(n,t)}function a(t,n){var a={module:"social",action:"getFriends",param:t};e.callRuntime(a,n)}function o(t,n){var a={module:"social",action:"openBBS",param:t};e.callRuntime(a,n)}t.isSupport=n,t.getFriends=a,t.openBBS=o}(t=e.social||(e.social={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(t){var n={module:"app",action:"isSupport"};e.callRuntime(n,t)}function a(t,n){var a={module:"app",action:"attention",param:t};e.callRuntime(a,n)}function o(t,n){var a={module:"app",action:"exitGame",param:t};e.callRuntime(a,n)}function r(t,n){var a={module:"app",action:"sendToDesktop",param:t};e.callRuntime(a,n)}function i(t,n){var a={module:"app",action:"getInfo",param:t};e.callRuntime(a,n)}t.isSupport=n,t.attention=a,t.exitGame=o,t.sendToDesktop=r,t.getInfo=i}(t=e.app||(e.app={}))}(nest||(nest={}));var nest;!function(e){function t(e,t,o){void 0===o&&(o=!1);var r="nest";o?(egret.ExternalInterface.addCallback(r,function(e){console.log(e);var n=JSON.parse(e);t(n.data)}),egret.ExternalInterface.call(r,JSON.stringify(e))):(a.push({data:e,callback:t}),n())}function n(){if(a.length){if(o)return;o=!0;var e=a.shift(),t="nest";egret.ExternalInterface.addCallback(t,function(t){console.log(t);var a=JSON.parse(t);e.callback(a.data),o=!1,n()}),egret.ExternalInterface.call(t,JSON.stringify(e.data))}}var a=[];e.callRuntime=t;var o=!1}(nest||(nest={}));var nest;!function(e){var t;!function(t){function n(){return null==t.spid&&(85==e.core.appId||88==e.core.appId?t.spid=10044:t.spid=18287,egret_native.setOption("egret.runtime.spid",t.spid)),t.spid}function a(e,t){var n;if(n=egret.localStorage.getItem("deviceid")){if(console.log("cm old local deviceid "+n),n.indexOf("{")>=0){var a=JSON.parse(n);e.postData.deviceid=a.did}else e.postData.deviceid=n;s(e.postData,t)}else{console.log("cm old CMPAY_EGRET.version "+CMPAY_EGRET.getVersion());var o=0==CMPAY_EGRET.getVersion()||0==CMPAY_EGRET.getVersion()?"getUid":"get_device_info",r=!1,i=function(n){r||(r=!0,console.log(n),e.postData.deviceid=n||egret.localStorage.getItem("deviceid")||"",s(e.postData,t))};egret.ExternalInterface.addCallback(o,function(e){if(console.log("cm old CMPAY_EGRET"),"get_device_info"==o)if(console.log("cm old get_device_info "+e),e){var t=JSON.parse(e);i(t.did)}else i(null);else i(e)}),egret.setTimeout(function(){console.log("cm old timeout"),i(null)},this,2e3),egret.ExternalInterface.call(o,"")}}function o(t){var a={},o="http://api.egret-labs.org/games/www/getAppInfo.php/";o+=e.core.appId+"_"+n(),a.debug=1,l(o,a,egret.URLRequestMethod.GET,function(e){t(e)})}function r(t,a,o){var r={};r.access_token=t.access_token,r.openid=t.openid;var i="http://api.egret-labs.org/games/www/game.php/";i+=e.core.appId+"_"+n(),r.runtime=1,r.showGame=1,o&&(r.newLiebaoApi=1),l(i,r,egret.URLRequestMethod.GET,function(e){a(e)})}function i(t,n){var a="http://api.egret-labs.org/games/api.php",o={action:"pay.buy",id:egretInfo.egretUserId,appId:e.core.appId,time:Date.now(),runtime:1};for(var r in t)o[r]=t[r];l(a,o,egret.URLRequestMethod.GET,function(e){n(e)})}function s(e,t){var n="http://gclogin.liebao.cn/api/user/quick_register";l(n,e,egret.URLRequestMethod.POST,t)}function l(e,t,n,a){var o="";for(var r in t)o+=r+"="+t[r]+"&";""!=o&&(o=o.substr(0,o.length-1)),console.log("cm old solution ="+e+"?"+o);var i=new egret.URLLoader;i.addEventListener(egret.Event.COMPLETE,function(){console.log("cm old solution  ="+i.data);var e=JSON.parse(i.data);a(e)},this);var s=new egret.URLRequest(e);s.method=n,s.data=new egret.URLVariables(o),i.load(s)}t.spid=null,t.getSpid=n,t.callRuntime=a,t.loginBefore=o,t.loginAfter=r,t.payBefore=i}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){var n;!function(t){function n(t,n){function a(e){egretInfo={egretUserId:e.data.id},e.data.result=e.status,n(e.data)}function o(t){1==t.ret?(t.access_token=t.ssid,egret.localStorage.getItem("deviceid")||egret.localStorage.setItem("deviceid",t.deviceid),e.cm.loginAfter(t,a,!1)):n({result:1})}function r(t){console.log("cm old loginHandler1"),console.log(JSON.stringify(t,null,4));var n={};n.access_token=t.cp.token,n.openid=t.user.openid,egret.localStorage.setItem("cm_token",n.access_token),console.log("cm old loginHandler2"),e.cm.loginAfter(n,a,!0)}function i(a){if(0==a.status){var i=a.data;s.client_id=i.client_id,s.client_secret=i.client_secret,s.redirect_uri=i.redirect_uri,e.cm.app.initDesktop({Title:i.title,DetailUrl:i.detailUrl,PicUrl:i.picUrl}),CMGAME_EGRET.checkIsGameSDK(function(n,a){if(n){console.log("cm old checkIsGameSDK1");var l={clientId:i.client_id,clientSecret:i.client_secret,redirectUri:i.redirect_uri};egret.localStorage.getItem("cm_token"),console.log(JSON.stringify(l,null,4)),console.log("cm old checkIsGameSDK2"),CMGAME_EGRET.dispatchGameLoginData(l,r)}else console.log("cm old checkIsGameSDK2"),e.cm.callRuntime({module:"user",action:"checkLogin",param:t,postData:s},o)})}else n({result:1})}var s={};e.cm.loginBefore(i)}function a(t,n){var a={module:"user",action:"login",param:t};e.cm.callRuntime(a,n)}t.checkLogin=n,t.login=a}(n=t.user||(t.user={}))}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;!function(e){var t;!function(t){var n;!function(n){function a(n,a){var o=0,r=-1,i=-2;t.payBefore(n,function(t){if(0==t.status){e.cm.iap.isFirst&&(CMPAY_EGRET.on("cmpay_order_complete",function(e){console.log("cm old solution cmpay_order_complete  "+JSON.stringify(e,null,4)),a(1==e.success?{result:o}:2==e.ret?{result:r}:{result:i})}),e.cm.iap.isFirst=!1);var n={access_token:t.data.access_token,client_id:t.data.client_id,product_id:t.data.product_id,unit:t.data.unit,payload:t.data.payload,notify_url:t.data.notify_url,money:t.data.money,order_name:t.data.order_name,game_icon:t.data.game_icon,game_name:t.data.game_name};CMPAY_EGRET.purchase(n)}else a({result:i})})}n.isFirst=!0,n.pay=a}(n=t.iap||(t.iap={}))}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(e){function t(e){e({status:0,share:0})}e.isSupport=t}(t=e.share||(e.share={}))}(t=e.cm||(e.cm={}))}(nest||(nest={}));var nest;if(function(e){var t;!function(e){var t;!function(e){function t(e){o=e,egret.ExternalInterface.call("save_shortcut_info",JSON.stringify({token:String(Math.random()),value:JSON.stringify(e)}))}function n(e){e(0!=CMPAY_EGRET.getVersion()&&!isNaN(CMPAY_EGRET.getVersion())&&CMPAY_EGRET.getVersion()>301030?{status:0,sendToDesktop:1,attention:0}:{status:0,sendToDesktop:0,attention:0})}function a(e,t){o?(egret.ExternalInterface.call("push_icon",JSON.stringify({title:o.Title,detailUrl:o.DetailUrl,picUrl:o.PicUrl})),t({result:0})):t({result:-1})}var o;e.initDesktop=t,e.isSupport=n,e.sendToDesktop=a}(t=e.app||(e.app={}))}(t=e.cm||(e.cm={}))}(nest||(nest={})),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(console.log("cm old 11111 "),console.log(egret_native.getOption("egret.runtime.spid")),console.log(egret_native.getOption("egret.runtime.nest")),console.log("cm old 22222 "),10044==egret_native.getOption("egret.runtime.spid")||!egret_native.getOption("egret.runtime.nest"))){console.log("cm old u r in cm");var egretInfo;egret_native.setOption("channelTag","liebao"),CMPAY_DEBUG=!1,nest.user.checkLogin=nest.cm.user.checkLogin,nest.iap.pay=nest.cm.iap.pay,nest.share.isSupport=nest.cm.share.isSupport,nest.app.isSupport=nest.cm.app.isSupport,nest.app.sendToDesktop=nest.cm.app.sendToDesktop}"egret_native"in this||(nest.user.checkLogin=function(e,t){EgretH5Sdk.checkLogin(t,this)},nest.user.login=function(e,t){EgretH5Sdk.login(t,this)});var nest;!function(e){var t;!function(e){e.uid=void 0}(t=e.h5||(e.h5={}))}(nest||(nest={})),egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(nest.user.isSupport=function(e){var t=egret.getOption("channelTag"),n=[];"QQBrowser"==t&&(n.push("qq"),n.push("wx"));var a={status:0,result:0,loginType:n,token:void 0,getInfo:0};e.call(null,a)},nest.user.checkLogin=function(e,t){var n=function(e){nest.h5.uid=e.id;var n=e.status;nest.h5.uid&&(n=0);var a={status:n,result:n,loginType:void 0,token:e.token};t.call(null,a)};EgretH5Sdk.checkLogin(n,null)},nest.user.login=function(e,t){var n=function(e){nest.h5.uid=e.id;var n=e.status;nest.h5.uid&&(n=0);var a={status:n,result:n,loginType:void 0,token:e.token};t.call(null,a)};EgretH5Sdk.login(n,null,e.loginType)},nest.user.logout=function(e,t){var n=function(e){var n=e.status,a=1==n?0:1;t.call(null,{result:a})};EgretH5Sdk.logout(n,null)},nest.iap.pay=function(e,t){nest.h5.uid&&(e.appId=nest.core.appId,e.uId=nest.h5.uid,EgretH5Sdk.pay(e,function(e){t(e)},this))},nest.share.isSupport=function(e){var t=function(t){var n=t.status,a={share:n};e.call(null,a)};EgretH5Sdk.isOpenShare(nest.core.appId,nest.h5.uid,t,null)},nest.share.share=function(e,t){var n=function(e){var n=e.status;0==n?n=-1:1==n&&(n=0);var a={status:n,result:n};t.call(null,a)};EgretH5Sdk.share(nest.core.appId,nest.h5.uid,e,n,null)},nest.social.isSupport=function(e){e.call(null,{result:0,getFriends:0,openBBS:0})},nest.social.getFriends=function(e,t){},nest.social.openBBS=function(e,t){},nest.app.isSupport=function(e){var t=function(t){var n=t.status,a={attention:n};e.call(null,a)};EgretH5Sdk.isOpenAttention(nest.core.appId,nest.h5.uid,t,null)},nest.app.attention=function(e,t){EgretH5Sdk.attention(nest.core.appId,nest.h5.uid),t.call(null,{result:0})},nest.app.sendToDesktop=function(e,t){t.call(null,{result:-1})},nest.app.getInfo=function(e,t){var n=function(e){var n={result:0,contact:e.contact};t.call(null,n)};EgretH5Sdk.getCustomInfo(nest.core.appId,nest.h5.uid,n,null)});var NestForQQHall=function(){function e(){}var t=(__define,e);t.prototype;return e}();egret.registerClass(NestForQQHall,"NestForQQHall");var nest;!function(e){var t;!function(t){function n(e,t,n,a){var o="";for(var r in t)o+=r+"="+t[r]+"&";""!=o&&(o=o.substr(0,o.length-1)),console.log("qq hall send : "+e+"?"+o);var i=new egret.URLLoader;i.addEventListener(egret.Event.COMPLETE,function(){console.log("qq hall get data : "+i.data);var e=JSON.parse(i.data);a(e)},this);var s=new egret.URLRequest(e);s.method=n,s.data=new egret.URLVariables(o),i.load(s)}function a(a,o){var r="http://api.gz.1251278653.clb.myqcloud.com/games/api.php",i={action:"pay.buy",id:t.userId,appId:e.core.appId,time:Date.now(),openid:t.OpenId,openkey:t.OpenKey,paytoken:t.payToken,runtime:1};for(var s in a)i[s]=a[s];n(r,i,egret.URLRequestMethod.GET,function(e){o(e)})}function o(e){var t=JSON.stringify(e);console.log("NestForQQHall::HALL_EGRET_MSG_FROM "+t),egret.ExternalInterface.call("HALL_EGRET_MSG_FROM",t)}t.login_call_type=102,t.login_back_call_type=100,t.pay_call_type=101,t.share_call_type=104,t.login_callback_type=200,t.pay_callback_type=201,t.share_callback_type=204,t.loginCallback=null,t.payCallback=null,t.shareCallback=null,t.version="V1.0.0",t.loginNum=0,t.spid=10835,t.payBefore=a,t.callHall=o,egret.ExternalInterface.addCallback("HALL_EGRET_MSG_TO",function(a){var r=JSON.parse(a);switch(console.log("NestForQQHall::HALL_EGRET_MSG_TO "+r),r.msgType){case t.login_callback_type:if(null==r.accessToken){if(t.loginNum++,t.loginNum>=3){var i={status:-1,result:-1,loginType:void 0,token:void 0};return t.loginCallback.call(null,i),void(t.loginCallback=null)}var s="OpenId/OpenKey 为空";return o({msgType:t.login_back_call_type,msgVersion:t.version,errorID:1,loginInfoStr:s}),void o({msgType:t.login_call_type,msgVersion:t.version})}if(t.loginCallback){t.gameType=r.msgType,t.gameVersion=r.msgVersion,t.OpenId=r.openId,t.OpenKey=r.accessToken,t.enterType=r.enterType,t.enterId=r.enterId,t.payToken=r.payToken;var s="登录成功";o({msgType:t.login_back_call_type,msgVersion:t.version,errorID:0,loginInfoStr:s});var l="http://api.gz.1251278653.clb.myqcloud.com/games/www/game.php/"+e.core.appId+"_"+t.spid,c={};c.openkey=t.OpenKey,c.openid=t.OpenId,c.paytoken=t.payToken,c.runtime=1,c.showGame=1,n(l,c,egret.URLRequestMethod.GET,function(e){console.log("loginCallbackInfo:"+JSON.stringify(e));var n=e.data;t.userId=n.id,t.loginCallback.call(null,n),t.loginCallback=null})}break;case t.pay_callback_type:if(t.payCallback){var u=-1;switch(r.payState){case-1:case 1:case 2:t.payOrderInfo=null,t.payCallback.call(null,{result:u,status:u}),t.payCallback=null;break;case 0:t.iap.repay()}}break;case t.share_callback_type:if(t.shareCallback){var u=r.errorid;t.shareCallback.call(null,{result:u,status:u}),t.shareCallback=null}}})}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(t){function n(e){console.log("NestForQQHall::user.isSupport");var t=0,n={status:t,result:t,checkLogin:0,login:1,logout:0,getInfo:0};e.call(null,n)}function a(e,t){console.log("NestForQQHall::checkLogin");var n=-1,a={status:n,result:n,loginType:void 0,token:void 0};t.call(null,a)}function o(t,n){console.log("NestForQQHall::login"),e.loginCallback=n,e.callHall({msgType:e.login_call_type,msgVersion:e.version})}t.isSupport=n,t.checkLogin=a,t.login=o}(t=e.user||(e.user={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(t){function n(t,n){e.payOrderInfo||(e.payOrderInfo=t,e.payBefore(t,function(t){t=t.data,0==t.status?n.call(null,{result:0,status:0}):(e.payCallback=n,e.callHall({msgType:e.pay_call_type,msgVersion:"V1.0.0",acctType:"",zoneId:"",payValue:t.qCoins,isCanChange:!1}))}))}function a(){if(e.payOrderInfo){var t=e.payOrderInfo,n=e.payCallback;e.payBefore(t,function(e){e=e.data;var t=e.status;n.call(null,{result:t,status:t})}),e.payOrderInfo=null,e.payCallback=null}}t.pay=n,t.repay=a}(t=e.iap||(e.iap={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(e){function t(e){var t=0,n={status:t,result:t,attention:0,sendToDesktop:0,exitGame:1};e.call(null,n)}function n(e){var t=0,n={status:t,result:t};e.call(null,n)}function a(e,t){}function o(e,t){}e.isSupport=t,e.exitGame=n,e.attention=a,e.sendToDesktop=o}(t=e.app||(e.app={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(t){function n(e){var t=0,n={status:t,result:t,share:1};e.call(null,n)}function a(t,n){e.shareCallback=n,e.callHall({msgType:e.share_call_type,msgVersion:"V1.0.0",title:t.title,summary:t.description,imageLocalUrl:"",targetUrl:t.url})}t.isSupport=n,t.share=a}(t=e.share||(e.share={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={}));var nest;!function(e){var t;!function(e){var t;!function(e){function t(e){var t=0,n={status:t,result:t,getFriends:0,openBBS:0};e.call(null,n)}function n(e,t){}function a(e,t){}e.isSupport=t,e.getFriends=n,e.openBBS=a}(t=e.social||(e.social={}))}(t=e.qqhall||(e.qqhall={}))}(nest||(nest={})),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&10835==parseInt(egret.getOption("egret.runtime.spid"))&&(nest.user.isSupport=nest.qqhall.user.isSupport,nest.user.checkLogin=nest.qqhall.user.checkLogin,nest.user.login=nest.qqhall.user.login,nest.iap.pay=nest.qqhall.iap.pay,nest.share.isSupport=nest.qqhall.share.isSupport,nest.share.share=nest.qqhall.share.share,nest.app.isSupport=nest.qqhall.app.isSupport,nest.app.attention=nest.qqhall.app.attention,nest.app.exitGame=nest.qqhall.app.exitGame,nest.app.sendToDesktop=nest.qqhall.app.sendToDesktop,nest.social.isSupport=nest.qqhall.social.isSupport,nest.social.getFriends=nest.qqhall.social.getFriends,nest.social.openBBS=nest.qqhall.social.openBBS);